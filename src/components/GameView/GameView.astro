---
export interface GameViewElement extends HTMLElement {
    runCode(code: string): void;
    run(): void;
    get iframe(): HTMLIFrameElement | null;
}
---

<game-view>
    <iframe height="100%" width="100%" />
</game-view>

<script>
import { gameViewElement, playgroundCode } from "../../stores/playground";
import { wrapCode } from "./wrapCode";

class GameViewElement extends HTMLElement {
    constructor() {
        super();
        const iframe = this.querySelector("iframe");
        if (!iframe) return;

        gameViewElement.set(this);
    }

    runCode(code: string) {
        const iframe = this.querySelector("iframe");
        if (!iframe) return;

        iframe.srcdoc = wrapCode(code);
    }

    run() {
        this.runCode(playgroundCode.get());
    }

    get iframe() {
        return this.querySelector("iframe");
    }
}

customElements.define("game-view", GameViewElement);
</script>
