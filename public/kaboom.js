var kaboom=(()=>{var on=Object.defineProperty;var cs=Object.getOwnPropertyDescriptor;var us=Object.getOwnPropertyNames;var ls=Object.prototype.hasOwnProperty;var i=(t,e)=>on(t,"name",{value:e,configurable:!0});var ms=(t,e)=>{for(var n in e)on(t,n,{get:e[n],enumerable:!0})},ds=(t,e,n,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of us(e))!ls.call(t,a)&&a!==n&&on(t,a,{get:()=>e[a],enumerable:!(o=cs(e,a))||o.enumerable});return t};var hs=t=>ds(on({},"__esModule",{value:!0}),t);var Dr=(()=>{for(var t=new Uint8Array(128),e=0;e<64;e++)t[e<26?e+65:e<52?e+71:e<62?e-4:e*4-205]=e;return n=>{for(var o=n.length,a=new Uint8Array((o-(n[o-1]=="=")-(n[o-2]=="="))*3/4|0),l=0,c=0;l<o;){var f=t[n.charCodeAt(l++)],x=t[n.charCodeAt(l++)],m=t[n.charCodeAt(l++)],O=t[n.charCodeAt(l++)];a[c++]=f<<2|x>>4,a[c++]=x<<4|m>>2,a[c++]=m<<6|O}return a}})();var ra={};ms(ra,{anchorPt:()=>pt,default:()=>na,getInternalContext:()=>pe,getKaboomContext:()=>W,isKaboomCtx:()=>oi});function xe(t){return t*Math.PI/180}i(xe,"deg2rad");function mt(t){return t*180/Math.PI}i(mt,"rad2deg");function Qe(t,e,n){return e>n?Qe(t,n,e):Math.min(Math.max(t,e),n)}i(Qe,"clamp");function Je(t,e,n){if(typeof t=="number"&&typeof e=="number")return t+(e-t)*n;if(t instanceof C&&e instanceof C)return t.lerp(e,n);if(t instanceof Z&&e instanceof Z)return t.lerp(e,n);throw new Error(`Bad value for lerp(): ${t}, ${e}. Only number, Vec2 and Color is supported.`)}i(Je,"lerp");function ht(t,e,n,o,a){return o+(t-e)/(n-e)*(a-o)}i(ht,"map");function Gr(t,e,n,o,a){return Qe(ht(t,e,n,o,a),o,a)}i(Gr,"mapc");var C=class t{static{i(this,"Vec2")}x=0;y=0;constructor(e=0,n=e){this.x=e,this.y=n}static fromAngle(e){let n=xe(e);return new t(Math.cos(n),Math.sin(n))}static LEFT=new t(-1,0);static RIGHT=new t(1,0);static UP=new t(0,-1);static DOWN=new t(0,1);clone(){return new t(this.x,this.y)}add(...e){let n=E(...e);return new t(this.x+n.x,this.y+n.y)}sub(...e){let n=E(...e);return new t(this.x-n.x,this.y-n.y)}scale(...e){let n=E(...e);return new t(this.x*n.x,this.y*n.y)}dist(...e){let n=E(...e);return this.sub(n).len()}sdist(...e){let n=E(...e);return this.sub(n).slen()}len(){return Math.sqrt(this.dot(this))}slen(){return this.dot(this)}unit(){let e=this.len();return e===0?new t(0):this.scale(1/e)}normal(){return new t(this.y,-this.x)}reflect(e){return this.sub(e.scale(2*this.dot(e)))}project(e){return e.scale(e.dot(this)/e.len())}reject(e){return this.sub(this.project(e))}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}angle(...e){let n=E(...e);return mt(Math.atan2(this.y-n.y,this.x-n.x))}angleBetween(...e){let n=E(...e);return mt(Math.atan2(this.cross(n),this.dot(n)))}lerp(e,n){return new t(Je(this.x,e.x,n),Je(this.y,e.y,n))}slerp(e,n){let o=this.dot(e),a=this.cross(e),l=Math.atan2(a,o);return this.scale(Math.sin((1-n)*l)).add(e.scale(Math.sin(n*l))).scale(1/a)}isZero(){return this.x===0&&this.y===0}toFixed(e){return new t(Number(this.x.toFixed(e)),Number(this.y.toFixed(e)))}transform(e){return e.multVec2(this)}eq(e){return this.x===e.x&&this.y===e.y}bbox(){return new ae(this,0,0)}toString(){return`vec2(${this.x.toFixed(2)}, ${this.y.toFixed(2)})`}};function E(...t){if(t.length===1){if(t[0]instanceof C)return new C(t[0].x,t[0].y);if(Array.isArray(t[0])&&t[0].length===2)return new C(...t[0])}return new C(...t)}i(E,"vec2");var Z=class t{static{i(this,"Color")}r=255;g=255;b=255;constructor(e,n,o){this.r=Qe(e,0,255),this.g=Qe(n,0,255),this.b=Qe(o,0,255)}static fromArray(e){return new t(e[0],e[1],e[2])}static fromHex(e){if(typeof e=="number")return new t(e>>16&255,e>>8&255,e>>0&255);if(typeof e=="string"){let n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return new t(parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16))}else throw new Error("Invalid hex color format")}static fromHSL(e,n,o){if(n==0)return new t(255*o,255*o,255*o);let a=i((O,g,U)=>(U<0&&(U+=1),U>1&&(U-=1),U<1/6?O+(g-O)*6*U:U<1/2?g:U<2/3?O+(g-O)*(2/3-U)*6:O),"hue2rgb"),l=o<.5?o*(1+n):o+n-o*n,c=2*o-l,f=a(c,l,e+1/3),x=a(c,l,e),m=a(c,l,e-1/3);return new t(Math.round(f*255),Math.round(x*255),Math.round(m*255))}static RED=new t(255,0,0);static GREEN=new t(0,255,0);static BLUE=new t(0,0,255);static YELLOW=new t(255,255,0);static MAGENTA=new t(255,0,255);static CYAN=new t(0,255,255);static WHITE=new t(255,255,255);static BLACK=new t(0,0,0);clone(){return new t(this.r,this.g,this.b)}lighten(e){return new t(this.r+e,this.g+e,this.b+e)}darken(e){return this.lighten(-e)}invert(){return new t(255-this.r,255-this.g,255-this.b)}mult(e){return new t(this.r*e.r/255,this.g*e.g/255,this.b*e.b/255)}lerp(e,n){return new t(Je(this.r,e.r,n),Je(this.g,e.g,n),Je(this.b,e.b,n))}toHSL(){let e=this.r/255,n=this.g/255,o=this.b/255,a=Math.max(e,n,o),l=Math.min(e,n,o),c=(a+l)/2,f=c,x=c;if(a==l)c=f=0;else{let m=a-l;switch(f=x>.5?m/(2-a-l):m/(a+l),a){case e:c=(n-o)/m+(n<o?6:0);break;case n:c=(o-e)/m+2;break;case o:c=(e-n)/m+4;break}c/=6}return[c,f,x]}eq(e){return this.r===e.r&&this.g===e.g&&this.b===e.b}toString(){return`rgb(${this.r}, ${this.g}, ${this.b})`}toHex(){return"#"+((1<<24)+(this.r<<16)+(this.g<<8)+this.b).toString(16).slice(1)}toArray(){return[this.r,this.g,this.b]}};function te(...t){if(t.length===0)return new Z(255,255,255);if(t.length===1){if(t[0]instanceof Z)return t[0].clone();if(typeof t[0]=="string")return Z.fromHex(t[0]);if(Array.isArray(t[0])&&t[0].length===3)return Z.fromArray(t[0])}return new Z(...t)}i(te,"rgb");var Br=i((t,e,n)=>Z.fromHSL(t,e,n),"hsl2rgb"),ue=class t{static{i(this,"Quad")}x=0;y=0;w=1;h=1;constructor(e,n,o,a){this.x=e,this.y=n,this.w=o,this.h=a}scale(e){return new t(this.x+this.w*e.x,this.y+this.h*e.y,this.w*e.w,this.h*e.h)}pos(){return new C(this.x,this.y)}clone(){return new t(this.x,this.y,this.w,this.h)}eq(e){return this.x===e.x&&this.y===e.y&&this.w===e.w&&this.h===e.h}toString(){return`quad(${this.x}, ${this.y}, ${this.w}, ${this.h})`}};function he(t,e,n,o){return new ue(t,e,n,o)}i(he,"quad");var At=class t{static{i(this,"Mat2")}a;b;c;d;constructor(e,n,o,a){this.a=e,this.b=n,this.c=o,this.d=a}mul(e){return new t(this.a*e.a+this.b*e.c,this.a*e.b+this.b*e.d,this.c*e.a+this.d*e.c,this.c*e.b+this.d*e.d)}transform(e){return E(this.a*e.x+this.b*e.y,this.c*e.x+this.d*e.y)}get inverse(){let e=this.det;return new t(this.d/e,-this.b/e,-this.c/e,this.a/e)}get transpose(){return new t(this.a,this.c,this.b,this.d)}get eigenvalues(){let e=this.trace/2,n=this.det,o=e+Math.sqrt(e*e-n),a=e-Math.sqrt(e*e-n);return[o,a]}eigenvectors(e,n){return this.c!=0?[[e-this.d,this.c],[n-this.d,this.c]]:this.b!=0?[[this.b,e-this.a],[this.b,n-this.a]]:Math.abs(this.transform(E(1,0)).x-e)<Number.EPSILON?[[1,0],[0,1]]:[[0,1],[1,0]]}get det(){return this.a*this.d-this.b*this.c}get trace(){return this.a+this.d}static rotation(e){let n=Math.cos(e),o=Math.sin(e);return new t(n,o,-o,n)}static scale(e,n){return new t(e,0,0,n)}};var bt=class t{static{i(this,"Mat3")}m11;m12;m13;m21;m22;m23;m31;m32;m33;constructor(e,n,o,a,l,c,f,x,m){this.m11=e,this.m12=n,this.m13=o,this.m21=a,this.m22=l,this.m23=c,this.m31=f,this.m32=x,this.m33=m}static fromMat2(e){return new t(e.a,e.b,0,e.c,e.d,0,0,0,1)}toMat2(){return new At(this.m11,this.m12,this.m21,this.m22)}mul(e){return new t(this.m11*e.m11+this.m12*e.m21+this.m13*e.m31,this.m11*e.m12+this.m12*e.m22+this.m13*e.m32,this.m11*e.m13+this.m12*e.m23+this.m13*e.m33,this.m21*e.m11+this.m22*e.m21+this.m23*e.m31,this.m21*e.m12+this.m22*e.m22+this.m23*e.m32,this.m21*e.m13+this.m22*e.m23+this.m23*e.m33,this.m31*e.m11+this.m32*e.m21+this.m33*e.m31,this.m31*e.m12+this.m32*e.m22+this.m33*e.m32,this.m31*e.m13+this.m32*e.m23+this.m33*e.m33)}get det(){return this.m11*this.m22*this.m33+this.m12*this.m23*this.m31+this.m13*this.m21*this.m32-this.m13*this.m22*this.m31-this.m12*this.m21*this.m33-this.m11*this.m23*this.m32}rotate(e){let n=Math.cos(e),o=Math.sin(e),a=this.m11,l=this.m12;return this.m11=n*this.m11+o*this.m21,this.m12=n*this.m12+o*this.m22,this.m21=n*this.m21-o*a,this.m22=n*this.m22-o*l,this}scale(e,n){return this.m11*=e,this.m12*=e,this.m21*=n,this.m22*=n,this}get inverse(){let e=this.det;return new t((this.m22*this.m33-this.m23*this.m32)/e,(this.m13*this.m32-this.m12*this.m33)/e,(this.m12*this.m23-this.m13*this.m22)/e,(this.m23*this.m31-this.m21*this.m33)/e,(this.m11*this.m33-this.m13*this.m31)/e,(this.m13*this.m21-this.m11*this.m23)/e,(this.m21*this.m32-this.m22*this.m31)/e,(this.m12*this.m31-this.m11*this.m32)/e,(this.m11*this.m22-this.m12*this.m21)/e)}get transpose(){return new t(this.m11,this.m21,this.m31,this.m12,this.m22,this.m32,this.m13,this.m23,this.m33)}},Me=class t{static{i(this,"Mat4")}m=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];constructor(e){e&&(this.m=e)}static translate(e){return new t([1,0,0,0,0,1,0,0,0,0,1,0,e.x,e.y,0,1])}static scale(e){return new t([e.x,0,0,0,0,e.y,0,0,0,0,1,0,0,0,0,1])}static rotateX(e){e=xe(-e);let n=Math.cos(e),o=Math.sin(e);return new t([1,0,0,0,0,n,-o,0,0,o,n,0,0,0,0,1])}static rotateY(e){e=xe(-e);let n=Math.cos(e),o=Math.sin(e);return new t([n,0,o,0,0,1,0,0,-o,0,n,0,0,0,0,1])}static rotateZ(e){e=xe(-e);let n=Math.cos(e),o=Math.sin(e);return new t([n,-o,0,0,o,n,0,0,0,0,1,0,0,0,0,1])}translate(e){return this.m[12]+=this.m[0]*e.x+this.m[4]*e.y,this.m[13]+=this.m[1]*e.x+this.m[5]*e.y,this.m[14]+=this.m[2]*e.x+this.m[6]*e.y,this.m[15]+=this.m[3]*e.x+this.m[7]*e.y,this}scale(e){return this.m[0]*=e.x,this.m[4]*=e.y,this.m[1]*=e.x,this.m[5]*=e.y,this.m[2]*=e.x,this.m[6]*=e.y,this.m[3]*=e.x,this.m[7]*=e.y,this}rotate(e){e=xe(-e);let n=Math.cos(e),o=Math.sin(e),a=this.m[0],l=this.m[1],c=this.m[4],f=this.m[5];return this.m[0]=a*n+l*o,this.m[1]=-a*o+l*n,this.m[4]=c*n+f*o,this.m[5]=-c*o+f*n,this}mult(e){let n=[];for(let o=0;o<4;o++)for(let a=0;a<4;a++)n[o*4+a]=this.m[0*4+a]*e.m[o*4+0]+this.m[1*4+a]*e.m[o*4+1]+this.m[2*4+a]*e.m[o*4+2]+this.m[3*4+a]*e.m[o*4+3];return new t(n)}multVec2(e){return new C(e.x*this.m[0]+e.y*this.m[4]+this.m[12],e.x*this.m[1]+e.y*this.m[5]+this.m[13])}getTranslation(){return new C(this.m[12],this.m[13])}getScale(){if(this.m[0]!=0||this.m[1]!=0){let e=this.m[0]*this.m[5]-this.m[1]*this.m[4],n=Math.sqrt(this.m[0]*this.m[0]+this.m[1]*this.m[1]);return new C(n,e/n)}else if(this.m[4]!=0||this.m[5]!=0){let e=this.m[0]*this.m[5]-this.m[1]*this.m[4],n=Math.sqrt(this.m[4]*this.m[4]+this.m[5]*this.m[5]);return new C(e/n,n)}else return new C(0,0)}getRotation(){if(this.m[0]!=0||this.m[1]!=0){let e=Math.sqrt(this.m[0]*this.m[0]+this.m[1]*this.m[1]);return mt(this.m[1]>0?Math.acos(this.m[0]/e):-Math.acos(this.m[0]/e))}else if(this.m[4]!=0||this.m[5]!=0){let e=Math.sqrt(this.m[4]*this.m[4]+this.m[5]*this.m[5]);return mt(Math.PI/2-(this.m[5]>0?Math.acos(-this.m[4]/e):-Math.acos(this.m[4]/e)))}else return 0}getSkew(){if(this.m[0]!=0||this.m[1]!=0){let e=Math.sqrt(this.m[0]*this.m[0]+this.m[1]*this.m[1]);return new C(Math.atan(this.m[0]*this.m[4]+this.m[1]*this.m[5])/(e*e),0)}else if(this.m[4]!=0||this.m[5]!=0){let e=Math.sqrt(this.m[4]*this.m[4]+this.m[5]*this.m[5]);return new C(0,Math.atan(this.m[0]*this.m[4]+this.m[1]*this.m[5])/(e*e))}else return new C(0,0)}invert(){let e=[],n=this.m[10]*this.m[15]-this.m[14]*this.m[11],o=this.m[9]*this.m[15]-this.m[13]*this.m[11],a=this.m[9]*this.m[14]-this.m[13]*this.m[10],l=this.m[8]*this.m[15]-this.m[12]*this.m[11],c=this.m[8]*this.m[14]-this.m[12]*this.m[10],f=this.m[8]*this.m[13]-this.m[12]*this.m[9],x=this.m[6]*this.m[15]-this.m[14]*this.m[7],m=this.m[5]*this.m[15]-this.m[13]*this.m[7],O=this.m[5]*this.m[14]-this.m[13]*this.m[6],g=this.m[4]*this.m[15]-this.m[12]*this.m[7],U=this.m[4]*this.m[14]-this.m[12]*this.m[6],w=this.m[5]*this.m[15]-this.m[13]*this.m[7],N=this.m[4]*this.m[13]-this.m[12]*this.m[5],z=this.m[6]*this.m[11]-this.m[10]*this.m[7],K=this.m[5]*this.m[11]-this.m[9]*this.m[7],G=this.m[5]*this.m[10]-this.m[9]*this.m[6],$=this.m[4]*this.m[11]-this.m[8]*this.m[7],A=this.m[4]*this.m[10]-this.m[8]*this.m[6],ne=this.m[4]*this.m[9]-this.m[8]*this.m[5];e[0]=this.m[5]*n-this.m[6]*o+this.m[7]*a,e[4]=-(this.m[4]*n-this.m[6]*l+this.m[7]*c),e[8]=this.m[4]*o-this.m[5]*l+this.m[7]*f,e[12]=-(this.m[4]*a-this.m[5]*c+this.m[6]*f),e[1]=-(this.m[1]*n-this.m[2]*o+this.m[3]*a),e[5]=this.m[0]*n-this.m[2]*l+this.m[3]*c,e[9]=-(this.m[0]*o-this.m[1]*l+this.m[3]*f),e[13]=this.m[0]*a-this.m[1]*c+this.m[2]*f,e[2]=this.m[1]*x-this.m[2]*m+this.m[3]*O,e[6]=-(this.m[0]*x-this.m[2]*g+this.m[3]*U),e[10]=this.m[0]*w-this.m[1]*g+this.m[3]*N,e[14]=-(this.m[0]*O-this.m[1]*U+this.m[2]*N),e[3]=-(this.m[1]*z-this.m[2]*K+this.m[3]*G),e[7]=this.m[0]*z-this.m[2]*$+this.m[3]*A,e[11]=-(this.m[0]*K-this.m[1]*$+this.m[3]*ne),e[15]=this.m[0]*G-this.m[1]*A+this.m[2]*ne;let k=this.m[0]*e[0]+this.m[1]*e[4]+this.m[2]*e[8]+this.m[3]*e[12];for(let oe=0;oe<4;oe++)for(let J=0;J<4;J++)e[oe*4+J]*=1/k;return new t(e)}clone(){return new t([...this.m])}toString(){return this.m.toString()}};function zn(t,e,n,o=a=>-Math.cos(a)){return t+(o(n)+1)/2*(e-t)}i(zn,"wave");var ps=1103515245,fs=12345,Mr=2147483648,It=class{static{i(this,"RNG")}seed;constructor(e){this.seed=e}gen(){return this.seed=(ps*this.seed+fs)%Mr,this.seed/Mr}genNumber(e,n){return e+this.gen()*(n-e)}genVec2(e,n){return new C(this.genNumber(e.x,n.x),this.genNumber(e.y,n.y))}genColor(e,n){return new Z(this.genNumber(e.r,n.r),this.genNumber(e.g,n.g),this.genNumber(e.b,n.b))}genAny(...e){if(e.length===0)return this.gen();if(e.length===1){if(typeof e[0]=="number")return this.genNumber(0,e[0]);if(e[0]instanceof C)return this.genVec2(E(0,0),e[0]);if(e[0]instanceof Z)return this.genColor(te(0,0,0),e[0])}else if(e.length===2){if(typeof e[0]=="number"&&typeof e[1]=="number")return this.genNumber(e[0],e[1]);if(e[0]instanceof C&&e[1]instanceof C)return this.genVec2(e[0],e[1]);if(e[0]instanceof Z&&e[1]instanceof Z)return this.genColor(e[0],e[1])}}},qn=new It(Date.now());function Fr(t){return t!=null&&(qn.seed=t),qn.seed}i(Fr,"randSeed");function Lt(...t){return qn.genAny(...t)}i(Lt,"rand");function Yn(...t){return Math.floor(Lt(...t))}i(Yn,"randi");function Ir(t){return Lt()<=t}i(Ir,"chance");function Xn(t){for(let e=t.length-1;e>0;e--){let n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t}i(Xn,"shuffle");function Lr(t,e){return t.length<=e?t.slice():Xn(t.slice()).slice(0,e)}i(Lr,"chooseMultiple");function kr(t){return t[Yn(t.length)]}i(kr,"choose");function $n(t,e){return t.pos.x+t.width>e.pos.x&&t.pos.x<e.pos.x+e.width&&t.pos.y+t.height>e.pos.y&&t.pos.y<e.pos.y+e.height}i($n,"testRectRect");function gs(t,e){if(t.p1.x===t.p2.x&&t.p1.y===t.p2.y||e.p1.x===e.p2.x&&e.p1.y===e.p2.y)return null;let n=(e.p2.y-e.p1.y)*(t.p2.x-t.p1.x)-(e.p2.x-e.p1.x)*(t.p2.y-t.p1.y);if(n===0)return null;let o=((e.p2.x-e.p1.x)*(t.p1.y-e.p1.y)-(e.p2.y-e.p1.y)*(t.p1.x-e.p1.x))/n,a=((t.p2.x-t.p1.x)*(t.p1.y-e.p1.y)-(t.p2.y-t.p1.y)*(t.p1.x-e.p1.x))/n;return o<0||o>1||a<0||a>1?null:o}i(gs,"testLineLineT");function an(t,e){let n=gs(t,e);return n?E(t.p1.x+n*(t.p2.x-t.p1.x),t.p1.y+n*(t.p2.y-t.p1.y)):null}i(an,"testLineLine");function cn(t,e){let n=e.p2.sub(e.p1),o=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY;if(n.x!=0){let l=(t.pos.x-e.p1.x)/n.x,c=(t.pos.x+t.width-e.p1.x)/n.x;o=Math.max(o,Math.min(l,c)),a=Math.min(a,Math.max(l,c))}if(n.y!=0){let l=(t.pos.y-e.p1.y)/n.y,c=(t.pos.y+t.height-e.p1.y)/n.y;o=Math.max(o,Math.min(l,c)),a=Math.min(a,Math.max(l,c))}return a>=o&&a>=0&&o<=1}i(cn,"testRectLine");function Wn(t,e){return e.x>t.pos.x&&e.x<t.pos.x+t.width&&e.y>t.pos.y&&e.y<t.pos.y+t.height}i(Wn,"testRectPoint");function jr(t,e){let n=Math.max(t.pos.x,Math.min(e.center.x,t.pos.x+t.width)),o=Math.max(t.pos.y,Math.min(e.center.y,t.pos.y+t.height));return E(n,o).sdist(e.center)<=e.radius*e.radius}i(jr,"testRectCircle");function Nr(t,e){return _r(e,new Oe(t.points()))}i(Nr,"testRectPolygon");function Qn(t,e){let n=e.sub(t.p1),o=t.p2.sub(t.p1);if(Math.abs(n.cross(o))>Number.EPSILON)return!1;let a=n.dot(o)/o.dot(o);return a>=0&&a<=1}i(Qn,"testLinePoint");function Ot(t,e){let n=t.p2.sub(t.p1),o=n.dot(n),a=t.p1.sub(e.center),l=2*n.dot(a),c=a.dot(a)-e.radius*e.radius,f=l*l-4*o*c;if(o<=Number.EPSILON||f<0)return!1;if(f==0){let x=-l/(2*o);if(x>=0&&x<=1)return!0}else{let x=(-l+Math.sqrt(f))/(2*o),m=(-l-Math.sqrt(f))/(2*o);if(x>=0&&x<=1||m>=0&&m<=1)return!0}return Zn(e,t.p1)}i(Ot,"testLineCircle");function Jn(t,e){if(dt(e,t.p1)||dt(e,t.p2))return!0;for(let n=0;n<e.pts.length;n++){let o=e.pts[n],a=e.pts[(n+1)%e.pts.length];if(an(t,new Ge(o,a)))return!0}return!1}i(Jn,"testLinePolygon");function Zn(t,e){return t.center.sdist(e)<t.radius*t.radius}i(Zn,"testCirclePoint");function bs(t,e){return t.center.sdist(e.center)<(t.radius+e.radius)*(t.radius+e.radius)}i(bs,"testCircleCircle");function kt(t,e){let n=e.pts[e.pts.length-1];for(let o of e.pts){if(Ot(new Ge(n,o),t))return!0;n=o}return Zn(t,e.pts[0])?!0:dt(e,t.center)}i(kt,"testCirclePolygon");function _r(t,e){for(let n=0;n<t.pts.length;n++)if(Jn(new Ge(t.pts[n],t.pts[(n+1)%t.pts.length]),e))return!0;return!!(t.pts.some(n=>dt(e,n))||e.pts.some(n=>dt(t,n)))}i(_r,"testPolygonPolygon");function dt(t,e){let n=!1,o=t.pts;for(let a=0,l=o.length-1;a<o.length;l=a++)o[a].y>e.y!=o[l].y>e.y&&e.x<(o[l].x-o[a].x)*(e.y-o[a].y)/(o[l].y-o[a].y)+o[a].x&&(n=!n);return n}i(dt,"testPolygonPoint");function Hr(t,e){e=e.sub(t.center);let n=xe(t.angle),o=Math.cos(n),a=Math.sin(n),l=e.x*o+e.y*a,c=-e.x*a+e.y*o;return l*l/(t.radiusX*t.radiusX)+c*c/(t.radiusY*t.radiusY)<1}i(Hr,"testEllipsePoint");function sn(t,e){let n=e.center.sub(t.center),o=xe(t.angle),a=Math.cos(o),l=Math.sin(o),c=n.x*a+n.y*l,f=-n.x*l+n.y*a;return Hr(new Ye(E(),t.radiusX+e.radius,t.radiusY+e.radius,0),E(c,f))}i(sn,"testEllipseCircle");function Kr(t,e){let n=t.toMat2().inverse;return e=new Ge(n.transform(e.p1.sub(t.center)),n.transform(e.p2.sub(t.center))),Ot(e,new Be(E(),1))}i(Kr,"testEllipseLine");function vs(t,e){if(t.radiusX===t.radiusY)return sn(e,new Be(t.center,t.radiusX));if(e.radiusX===e.radiusY)return sn(t,new Be(e.center,e.radiusX));let n=new bt(1/t.radiusX**2,0,0,0,1/t.radiusY**2,0,0,0,-1),o=new bt(1/e.radiusX**2,0,0,0,1/e.radiusY**2,0,0,0,-1),a=t.center.x,l=t.center.y,c=e.center.x,f=e.center.y,x=xe(t.angle),m=xe(e.angle),O=new bt(Math.cos(x),-Math.sin(x),a,Math.sin(x),Math.cos(x),l,0,0,1),g=new bt(Math.cos(m),-Math.sin(m),c,Math.sin(m),Math.cos(m),f,0,0,1),U=O.inverse,w=g.inverse,N=U.transpose.mul(n).mul(U),z=w.transpose.mul(o).mul(w),K=N.m11,G=N.m12,$=N.m13,A=N.m21,ne=N.m22,k=N.m23,oe=N.m31,J=N.m32,ie=N.m33,fe=z.m11,Ue=z.m12,we=z.m13,Ie=z.m21,Le=z.m22,Ee=z.m23,je=z.m31,Ne=z.m32,_e=z.m33,ft=K*ne*ie-K*k*J-G*A*ie+G*k*oe+$*A*J-$*ne*oe,Se=(K*ne*_e-K*k*Ne-K*J*Ee+K*ie*Le-G*A*_e+G*k*je+G*oe*Ee-G*ie*Ie+$*A*Ne-$*ne*je-$*oe*Le+$*J*Ie+A*J*we-A*ie*Ue-ne*oe*we+ne*ie*fe+k*oe*Ue-k*J*fe)/ft,Ve=(K*Le*_e-K*Ee*Ne-G*Ie*_e+G*Ee*je+$*Ie*Ne-$*Le*je-A*Ue*_e+A*we*Ne+ne*fe*_e-ne*we*je-k*fe*Ne+k*Ue*je+oe*Ue*Ee-oe*we*Le-J*fe*Ee+J*we*Ie+ie*fe*Le-ie*Ue*Ie)/ft,ze=(fe*Le*_e-fe*Ee*Ne-Ue*Ie*_e+Ue*Ee*je+we*Ie*Ne-we*Le*je)/ft;if(Se>=0){let rt=-3*Ve+Se**2,ot=3*Se*ze+Ve*Se**2-4*Ve**2,wt=-27*ze**2+18*ze*Se*Ve+Se**2*Ve**2-4*Se**3*ze-4*Ve**3;return!(rt>0&&ot<0&&wt>0)}else{let rt=-3*Ve+Se**2,ot=-27*ze**2+18*ze*Se*Ve+Se**2*Ve**2-4*Se**3*ze-4*Ve**3;return!(rt>0&&ot>0)}}i(vs,"testEllipseEllipse");function qr(t,e){return er(t,new Oe(e.points()))}i(qr,"testEllipseRect");function er(t,e){let n=t.toMat2().inverse;return e=new Oe(e.pts.map(o=>n.transform(o.sub(t.center)))),kt(new Be(E(),1),e)}i(er,"testEllipsePolygon");function xs(t,e){return e instanceof C?Qn(t,e):e instanceof Be?Ot(t,e):e instanceof Ge?an(t,e)!=null:e instanceof ae?cn(e,t):e instanceof Oe?Jn(t,e):e instanceof Ye?Kr(e,t):!1}i(xs,"testLineShape");function ys(t,e){return e instanceof C?Zn(t,e):e instanceof Be?bs(t,e):e instanceof Ge?Ot(e,t):e instanceof ae?jr(e,t):e instanceof Oe?kt(t,e):e instanceof Ye?sn(e,t):!1}i(ys,"testCircleShape");function ws(t,e){return e instanceof C?Wn(t,e):e instanceof Be?jr(t,e):e instanceof Ge?cn(t,e):e instanceof ae?$n(t,e):e instanceof Oe?Nr(t,e):e instanceof Ye?qr(e,t):!1}i(ws,"testRectShape");function Cs(t,e){return e instanceof C?dt(t,e):e instanceof Be?kt(e,t):e instanceof Ge?Jn(e,t):e instanceof ae?Nr(e,t):e instanceof Oe?_r(e,t):e instanceof Ye?er(e,t):!1}i(Cs,"testPolygonShape");function Es(t,e){return e instanceof C?Hr(t,e):e instanceof Be?sn(t,e):e instanceof Ge?Kr(t,e):e instanceof ae?qr(t,e):e instanceof Oe?er(t,e):e instanceof Ye?vs(e,t):!1}i(Es,"testEllipseShape");function zr(t,e,n){let o=t,a=n.p1,l=n.p2,c=e,f=l.sub(a),x=c.cross(f);if(Math.abs(x)<Number.EPSILON)return null;let m=a.sub(o),O=m.cross(f)/x;if(O<=0||O>=1)return null;let g=m.cross(c)/x;if(g<=0||g>=1)return null;let U=f.normal().unit();return e.dot(U)>0&&(U.x*=-1,U.y*=-1),{point:o.add(c.scale(O)),normal:U,fraction:O}}i(zr,"raycastLine");function Ts(t,e,n){let o=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY,l;if(t.x!=0){let c=(n.pos.x-t.x)/e.x,f=(n.pos.x+n.width-t.x)/e.x;l=E(-Math.sign(e.x),0),o=Math.max(o,Math.min(c,f)),a=Math.min(a,Math.max(c,f))}if(t.y!=0){let c=(n.pos.y-t.y)/e.y,f=(n.pos.y+n.height-t.y)/e.y;Math.min(c,f)>o&&(l=E(0,-Math.sign(e.y))),o=Math.max(o,Math.min(c,f)),a=Math.min(a,Math.max(c,f))}return a>=o&&o>=0&&o<=1?{point:t.add(e.scale(o)),normal:l,fraction:o}:null}i(Ts,"raycastRect");function Yr(t,e,n){let o=t,a=n.center,l=e,c=l.dot(l),f=o.sub(a),x=2*l.dot(f),m=f.dot(f)-n.radius*n.radius,O=x*x-4*c*m;if(c<=Number.EPSILON||O<0)return null;if(O==0){let g=-x/(2*c);if(g>=0&&g<=1){let U=o.add(l.scale(g));return{point:U,normal:U.sub(a),fraction:g}}}else{let g=(-x+Math.sqrt(O))/(2*c),U=(-x-Math.sqrt(O))/(2*c),w=null;if(g>=0&&g<=1&&(w=g),U>=0&&U<=1&&(w=Math.min(U,w??U)),w!=null){let N=o.add(l.scale(w));return{point:N,normal:N.sub(a).unit(),fraction:w}}}return null}i(Yr,"raycastCircle");function Ss(t,e,n){let o=n.pts,a=null,l=o[o.length-1];for(let c=0;c<o.length;c++){let f=o[c],x=zr(t,e,new Ge(l,f));x&&(!a||a.fraction>x.fraction)&&(a=x),l=f}return a}i(Ss,"raycastPolygon");function As(t,e,n){let o=n.toMat2(),a=o.inverse,l=a.transform(t.sub(n.center)),c=a.transform(e),f=Yr(l,c,new Be(E(),1));if(f){let x=At.rotation(xe(-n.angle)),O=At.scale(n.radiusX,n.radiusY).transform(f.point),g=o.transform(f.point).add(n.center),U=g.dist(t)/e.len();return{point:g,normal:x.transform(E(n.radiusY**2*O.x,n.radiusX**2*O.y)),fraction:U}}return f}i(As,"raycastEllipse");function Xr(t,e,n,o=64){let a=t,l=e.len(),c=e.scale(1/l),f=0,x=E(Math.floor(t.x),Math.floor(t.y)),m=E(c.x>0?1:-1,c.y>0?1:-1),O=E(Math.abs(1/c.x),Math.abs(1/c.y)),g=E(m.x>0?x.x+1-t.x:t.x-x.x,m.y>0?x.y+1-t.y:t.y-x.y),U=E(O.x<1/0?O.x*g.x:1/0,O.y<1/0?O.y*g.y:1/0),w=-1;for(;f<=o;){let N=n(x);if(N===!0)return{point:a.add(c.scale(f)),normal:E(w===0?-m.x:0,w===1?-m.y:0),fraction:f/l,gridPos:x};if(N)return N;U.x<U.y?(x.x+=m.x,f=U.x,U.x+=O.x,w=0):(x.y+=m.y,f=U.y,U.y+=O.y,w=1)}return null}i(Xr,"raycastGrid");var Ge=class t{static{i(this,"Line")}p1;p2;constructor(e,n){this.p1=e.clone(),this.p2=n.clone()}transform(e){return new t(e.multVec2(this.p1),e.multVec2(this.p2))}bbox(){return ae.fromPoints(this.p1,this.p2)}area(){return this.p1.dist(this.p2)}clone(){return new t(this.p1,this.p2)}collides(e){return xs(this,e)}contains(e){return this.collides(e)}raycast(e,n){return zr(e,n,this)}},ae=class t{static{i(this,"Rect")}pos;width;height;constructor(e,n,o){this.pos=e.clone(),this.width=n,this.height=o}static fromPoints(e,n){return new t(e.clone(),n.x-e.x,n.y-e.y)}center(){return new C(this.pos.x+this.width/2,this.pos.y+this.height/2)}points(){return[this.pos,this.pos.add(this.width,0),this.pos.add(this.width,this.height),this.pos.add(0,this.height)]}transform(e){return new Oe(this.points().map(n=>e.multVec2(n)))}bbox(){return this.clone()}area(){return this.width*this.height}clone(){return new t(this.pos.clone(),this.width,this.height)}distToPoint(e){return Math.sqrt(this.sdistToPoint(e))}sdistToPoint(e){let n=this.pos,o=this.pos.add(this.width,this.height),a=Math.max(n.x-e.x,0,e.x-o.x),l=Math.max(n.y-e.y,0,e.y-o.y);return a*a+l*l}collides(e){return ws(this,e)}contains(e){return this.collides(e)}raycast(e,n){return Ts(e,n,this)}},Be=class t{static{i(this,"Circle")}center;radius;constructor(e,n){this.center=e.clone(),this.radius=n}transform(e){return new Ye(this.center,this.radius,this.radius).transform(e)}bbox(){return ae.fromPoints(this.center.sub(E(this.radius)),this.center.add(E(this.radius)))}area(){return this.radius*this.radius*Math.PI}clone(){return new t(this.center,this.radius)}collides(e){return ys(this,e)}contains(e){return this.collides(e)}raycast(e,n){return Yr(e,n,this)}},Ye=class t{static{i(this,"Ellipse")}center;radiusX;radiusY;angle;constructor(e,n,o,a=0){this.center=e.clone(),this.radiusX=n,this.radiusY=o,this.angle=a}static fromMat2(e){let n=e.inverse,o=n.transpose.mul(n),[a,l]=o.eigenvalues,[c,f]=o.eigenvectors(a,l),[x,m]=[1/Math.sqrt(a),1/Math.sqrt(l)];return x>m?new t(E(),x,m,mt(Math.atan2(-c[1],c[0]))):new t(E(),m,x,mt(Math.atan2(-f[1],f[0])))}toMat2(){let e=xe(this.angle),n=Math.cos(e),o=Math.sin(e);return new At(n*this.radiusX,o*this.radiusY,-o*this.radiusX,n*this.radiusY)}transform(e){if(this.angle==0&&e.getRotation()==0)return new t(e.multVec2(this.center),e.m[0]*this.radiusX,e.m[5]*this.radiusY);{let n=this.toMat2(),o=e.getRotation(),a=e.getScale();n=bt.fromMat2(n).scale(a.x,a.y).rotate(o).toMat2();let c=t.fromMat2(n);return c.center=e.multVec2(this.center),c}}bbox(){if(this.angle==0)return ae.fromPoints(this.center.sub(E(this.radiusX,this.radiusY)),this.center.add(E(this.radiusX,this.radiusY)));{let e=xe(this.angle),n=Math.cos(e),o=Math.sin(e),a=this.radiusX*n,l=this.radiusX*o,c=this.radiusY*o,f=this.radiusY*n,x=Math.sqrt(a*a+c*c),m=Math.sqrt(l*l+f*f);return ae.fromPoints(this.center.sub(E(x,m)),this.center.add(E(x,m)))}}area(){return this.radiusX*this.radiusY*Math.PI}clone(){return new t(this.center,this.radiusX,this.radiusY,this.angle)}collides(e){return Es(this,e)}contains(e){e=e.sub(this.center);let n=xe(this.angle),o=Math.cos(n),a=Math.sin(n),l=e.x*o+e.y*a,c=-e.x*a+e.y*o;return l*l/(this.radiusX*this.radiusX)+c*c/(this.radiusY*this.radiusY)<1}raycast(e,n){return As(e,n,this)}},Oe=class t{static{i(this,"Polygon")}pts;constructor(e){if(e.length<3)throw new Error("Polygons should have at least 3 vertices");this.pts=e}transform(e){return new t(this.pts.map(n=>e.multVec2(n)))}bbox(){let e=E(Number.MAX_VALUE),n=E(-Number.MAX_VALUE);for(let o of this.pts)e.x=Math.min(e.x,o.x),n.x=Math.max(n.x,o.x),e.y=Math.min(e.y,o.y),n.y=Math.max(n.y,o.y);return ae.fromPoints(e,n)}area(){let e=0,n=this.pts.length;for(let o=0;o<n;o++){let a=this.pts[o],l=this.pts[(o+1)%n];e+=a.x*l.y*.5,e-=l.x*a.y*.5}return Math.abs(e)}clone(){return new t(this.pts.map(e=>e.clone()))}collides(e){return Cs(this,e)}contains(e){return this.collides(e)}raycast(e,n){return Ss(e,n,this)}};function tr(t,e,n,o,a){let l=a*a,c=l*a,f=1-a,x=f*f,m=x*f;return t.scale(m).add(e.scale(3*x*a)).add(n.scale(3*f*l)).add(o.scale(c))}i(tr,"evaluateBezier");function $r(t,e){let n=Number.MAX_VALUE,o=E(0);for(let a of[t,e])for(let l=0;l<a.pts.length;l++){let c=a.pts[l],x=a.pts[(l+1)%a.pts.length].sub(c).normal().unit(),m=Number.MAX_VALUE,O=-Number.MAX_VALUE;for(let N=0;N<t.pts.length;N++){let z=t.pts[N].dot(x);m=Math.min(m,z),O=Math.max(O,z)}let g=Number.MAX_VALUE,U=-Number.MAX_VALUE;for(let N=0;N<e.pts.length;N++){let z=e.pts[N].dot(x);g=Math.min(g,z),U=Math.max(U,z)}let w=Math.min(O,U)-Math.max(m,g);if(w<0)return null;if(w<Math.abs(n)){let N=U-m,z=g-O;n=Math.abs(N)<Math.abs(z)?N:z,o=x.scale(n)}}return o}i($r,"sat");function Wr(t,e,n){return(e.x-t.x)*(n.y-t.y)-(e.y-t.y)*(n.x-t.x)>=0}i(Wr,"isOrientedCcw");function Os(t){let e=0,n=t[t.length-1];for(let o=0;o<t.length;o++)e+=(t[o].x-n.x)*(t[o].y+n.y),n=t[o];return e<0}i(Os,"isOrientedCcwPolygon");function Kn(t,e,n,o){let a=o.x-n.x,l=o.y-n.y,c=a*(t.y-n.y)-l*(t.x-n.x),f=a*(e.y-n.y)-l*(e.x-n.x);return c*f>=0}i(Kn,"onSameSide");function Rs(t,e,n,o){return Kn(t,e,n,o)&&Kn(t,n,e,o)&&Kn(t,o,e,n)}i(Rs,"pointInTriangle");function Us(t,e,n,o){for(let a of t)if(a!==e&&a!==n&&a!==o&&Rs(a,e,n,o))return!0;return!1}i(Us,"someInTriangle");function Vs(t,e,n,o){return Wr(t,e,n)&&!Us(o,t,e,n)}i(Vs,"isEar");function nr(t){if(t.length<3)return[];if(t.length==3)return[t];let e=[],n=[],o=0;for(let g=0;g<t.length;g++){let U=t[o],w=t[g];(w.x<U.x||w.x==U.x&&w.y<U.y)&&(o=o),e[g]=g+1,n[g]=g-1}e[e.length-1]=0,n[0]=n.length-1,Os(t)||([e,n]=[n,e]);let a=[];for(let g=0;g<t.length;++g)Wr(t[n[g]],t[g],t[e[g]])||a.push(t[g]);let l=[],c=t.length,f=1,x=0,m,O;for(;c>3;){m=e[f],O=n[f];let g=t[O],U=t[f],w=t[m];if(Vs(g,U,w,a))l.push([g,U,w]),e[O]=m,n[m]=O,a.splice(a.indexOf(U),1),--c,x=0;else if(++x>c)return[];f=m}return m=e[f],O=n[f],l.push([t[O],t[f],t[m]]),l}i(nr,"triangulate");function rr(t){if(t.length<3)return!1;let e=t.length-2,n=t.length-1,o=0,a=t[n].sub(t[e]),l=t[o].sub(t[n]),c=a.cross(l);for(;o+1<t.length;)if(e=n,n=o,o++,a=t[n].sub(t[e]),l=t[o].sub(t[n]),a.cross(l)*c<0)return!1;return!0}i(rr,"isConvex");var jt=class extends Map{static{i(this,"Registry")}lastID=0;push(e){let n=this.lastID;return this.set(n,e),this.lastID++,n}pushd(e){let n=this.push(e);return()=>this.delete(n)}},et=class t{static{i(this,"EventController")}paused=!1;cancel;constructor(e){this.cancel=e}static join(e){let n=new t(()=>e.forEach(o=>o.cancel()));return Object.defineProperty(n,"paused",{get:()=>e[0].paused,set:o=>e.forEach(a=>a.paused=o)}),n.paused=!1,n}},ye=class{static{i(this,"Event")}handlers=new jt;add(e){let n=this.handlers.pushd((...a)=>{o.paused||e(...a)}),o=new et(n);return o}addOnce(e){let n=this.add((...o)=>{n.cancel(),e(...o)});return n}next(){return new Promise(e=>this.addOnce(e))}trigger(...e){this.handlers.forEach(n=>n(...e))}numListeners(){return this.handlers.size}clear(){this.handlers.clear()}},tt=class{static{i(this,"EventHandler")}handlers={};on(e,n){return this.handlers[e]||(this.handlers[e]=new ye),this.handlers[e].add(n)}onOnce(e,n){let o=this.on(e,(...a)=>{o.cancel(),n(...a)});return o}next(e){return new Promise(n=>{this.onOnce(e,(...o)=>n(o[0]))})}trigger(e,...n){this.handlers[e]&&this.handlers[e].trigger(...n)}remove(e){delete this.handlers[e]}clear(){this.handlers={}}numListeners(e){return this.handlers[e]?.numListeners()??0}};function ln(t,e){if(t===e)return!0;let n=typeof t,o=typeof e;if(n!==o)return!1;if(n==="object"&&o==="object"&&t!==null&&e!==null){if(Array.isArray(t)!==Array.isArray(e))return!1;let a=Object.keys(t),l=Object.keys(e);if(a.length!==l.length)return!1;for(let c of a){let f=t[c],x=e[c];if(!ln(f,x))return!1}return!0}return!1}i(ln,"deepEq");function Ps(t){let e=window.atob(t),n=e.length,o=new Uint8Array(n);for(let a=0;a<n;a++)o[a]=e.charCodeAt(a);return o.buffer}i(Ps,"base64ToArrayBuffer");function Jr(t){return Ps(t.split(",")[1])}i(Jr,"dataURLToArrayBuffer");function mn(t,e){let n=document.createElement("a");n.href=e,n.download=t,n.click()}i(mn,"download");function or(t,e){mn(t,"data:text/plain;charset=utf-8,"+e)}i(or,"downloadText");function Zr(t,e){or(t,JSON.stringify(e))}i(Zr,"downloadJSON");function ir(t,e){let n=URL.createObjectURL(e);mn(t,n),URL.revokeObjectURL(n)}i(ir,"downloadBlob");var sr=i(t=>t.match(/^data:\w+\/\w+;base64,.+/),"isDataURL");var eo=i(t=>t.split(".").slice(0,-1).join("."),"getFileName");function Fe(t,e){return(...n)=>{let o=n.length;if(o===t.length)return t(...n);if(o===e.length)return e(...n)}}i(Fe,"overload2");var to=(()=>{let t=0;return()=>t++})(),no=i(t=>t instanceof Error?t.message:String(t),"getErrorMessage");var un=class{static{i(this,"BinaryHeap")}_items;_compareFn;constructor(e=(n,o)=>n<o){this._compareFn=e,this._items=[]}insert(e){this._items.push(e),this.moveUp(this._items.length-1)}remove(){if(this._items.length===0)return null;let e=this._items[0],n=this._items.pop();return this._items.length!==0&&(this._items[0]=n,this.moveDown(0)),e}clear(){this._items.splice(0,this._items.length)}moveUp(e){for(;e>0;){let n=Math.floor((e-1)/2);if(!this._compareFn(this._items[e],this._items[n])&&this._items[e]>=this._items[n])break;this.swap(e,n),e=n}}moveDown(e){for(;e<Math.floor(this._items.length/2);){let n=2*e+1;if(n<this._items.length-1&&!this._compareFn(this._items[n],this._items[n+1])&&++n,this._compareFn(this._items[e],this._items[n]))break;this.swap(e,n),e=n}}swap(e,n){[this._items[e],this._items[n]]=[this._items[n],this._items[e]]}get length(){return this._items.length}};var Ds=Object.freeze([776,2359,2367,2984,3007,3021,3633,3635,3648,3657,4352,4449,4520]);function ro(t){if(typeof t!="string")throw new TypeError("string cannot be undefined or null");let e=[],n=0,o=0;for(;n<t.length;){if(o+=Ms(n+o,t),js(t[n+o])&&o++,Is(t[n+o])&&o++,Ls(t[n+o])&&o++,Ns(t[n+o])){o++;continue}e.push(t.substring(n,n+o)),n+=o,o=0}return e}i(ro,"runes");function Ms(t,e){let n=e[t];if(!Gs(n)||t===e.length-1)return 1;let o=n+e[t+1],a=e.substring(t+2,t+5);return Qr(o)&&Qr(a)?4:Bs(o)&&ks(a)?e.slice(t).indexOf(String.fromCodePoint(917631))+2:Fs(a)?4:2}i(Ms,"nextUnits");function Gs(t){return t&&vt(t[0].charCodeAt(0),55296,56319)}i(Gs,"isFirstOfSurrogatePair");function Qr(t){return vt(ar(t),127462,127487)}i(Qr,"isRegionalIndicator");function Bs(t){return vt(ar(t),127988,127988)}i(Bs,"isSubdivisionFlag");function Fs(t){return vt(ar(t),127995,127999)}i(Fs,"isFitzpatrickModifier");function Is(t){return typeof t=="string"&&vt(t.charCodeAt(0),65024,65039)}i(Is,"isVariationSelector");function Ls(t){return typeof t=="string"&&vt(t.charCodeAt(0),8400,8447)}i(Ls,"isDiacriticalMark");function ks(t){let e=t.codePointAt(0);return typeof t=="string"&&typeof e=="number"&&vt(e,917504,917631)}i(ks,"isSupplementarySpecialpurposePlane");function js(t){return typeof t=="string"&&Ds.includes(t.charCodeAt(0))}i(js,"isGrapheme");function Ns(t){return typeof t=="string"&&t.charCodeAt(0)===8205}i(Ns,"isZeroWidthJoiner");function ar(t){let e=t.charCodeAt(0)-55296,n=t.charCodeAt(1)-56320;return(e<<10)+n+65536}i(ar,"codePointFromSurrogatePair");function vt(t,e,n){return t>=e&&t<=n}i(vt,"betweenInclusive");var cr={"Joy-Con L+R (STANDARD GAMEPAD Vendor: 057e Product: 200e)":{buttons:{"0":"south","1":"east","2":"west","3":"north","4":"lshoulder","5":"rshoulder","6":"ltrigger","7":"rtrigger","8":"select","9":"start","10":"lstick","11":"rstick","12":"dpad-up","13":"dpad-down","14":"dpad-left","15":"dpad-right","16":"home","17":"capture"},sticks:{left:{x:0,y:1},right:{x:2,y:3}}},"Joy-Con (L) (STANDARD GAMEPAD Vendor: 057e Product: 2006)":{buttons:{"0":"south","1":"east","2":"west","3":"north","4":"lshoulder","5":"rshoulder","9":"select","10":"lstick","16":"start"},sticks:{left:{x:0,y:1}}},"Joy-Con (R) (STANDARD GAMEPAD Vendor: 057e Product: 2007)":{buttons:{"0":"south","1":"east","2":"west","3":"north","4":"lshoulder","5":"rshoulder","9":"start","10":"lstick","16":"select"},sticks:{left:{x:0,y:1}}},"Pro Controller (STANDARD GAMEPAD Vendor: 057e Product: 2009)":{buttons:{"0":"south","1":"east","2":"west","3":"north","4":"lshoulder","5":"rshoulder","6":"ltrigger","7":"rtrigger","8":"select","9":"start","10":"lstick","11":"rstick","12":"dpad-up","13":"dpad-down","14":"dpad-left","15":"dpad-right","16":"home","17":"capture"},sticks:{left:{x:0,y:1},right:{x:2,y:3}}},default:{buttons:{"0":"south","1":"east","2":"west","3":"north","4":"lshoulder","5":"rshoulder","6":"ltrigger","7":"rtrigger","8":"select","9":"start","10":"lstick","11":"rstick","12":"dpad-up","13":"dpad-down","14":"dpad-left","15":"dpad-right","16":"home"},sticks:{left:{x:0,y:1},right:{x:2,y:3}}}};var Rt=class{static{i(this,"ButtonState")}pressed=new Set([]);pressedRepeat=new Set([]);released=new Set([]);down=new Set([]);update(){this.pressed.clear(),this.released.clear(),this.pressedRepeat.clear()}press(e){this.pressed.add(e),this.pressedRepeat.add(e),this.down.add(e)}pressRepeat(e){this.pressedRepeat.add(e)}release(e){this.down.delete(e),this.pressed.delete(e),this.released.add(e)}},ur=class{static{i(this,"GamepadState")}buttonState=new Rt;stickState=new Map},lr=class{static{i(this,"FPSCounter")}dts=[];timer=0;fps=0;tick(e){this.dts.push(e),this.timer+=e,this.timer>=1&&(this.timer=0,this.fps=Math.round(1/(this.dts.reduce((n,o)=>n+o)/this.dts.length)),this.dts=[])}},oo=i(t=>{if(!t.canvas)throw new Error("Please provide a canvas");let e={canvas:t.canvas,loopID:null,stopped:!1,dt:0,time:0,realTime:0,fpsCounter:new lr,timeScale:1,skipTime:!1,isHidden:!1,numFrames:0,mousePos:new C(0),mouseDeltaPos:new C(0),keyState:new Rt,mouseState:new Rt,mergedGamepadState:new ur,gamepadStates:new Map,gamepads:[],charInputted:[],isMouseMoved:!1,lastWidth:t.canvas.offsetWidth,lastHeight:t.canvas.offsetHeight,events:new tt};function n(){return e.dt*e.timeScale}i(n,"dt");function o(){return e.isHidden}i(o,"isHidden");function a(){return e.time}i(a,"time");function l(){return e.fpsCounter.fps}i(l,"fps");function c(){return e.numFrames}i(c,"numFrames");function f(){return e.canvas.toDataURL()}i(f,"screenshot");function x(h){e.canvas.style.cursor=h}i(x,"setCursor");function m(){return e.canvas.style.cursor}i(m,"getCursor");function O(h){if(h)try{let T=e.canvas.requestPointerLock();T.catch&&T.catch(D=>console.error(D))}catch(T){console.error(T)}else document.exitPointerLock()}i(O,"setCursorLocked");function g(){return!!document.pointerLockElement}i(g,"isCursorLocked");function U(h){h.requestFullscreen?h.requestFullscreen():h.webkitRequestFullscreen&&h.webkitRequestFullscreen()}i(U,"enterFullscreen");function w(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullScreen&&document.webkitExitFullScreen()}i(w,"exitFullscreen");function N(){return document.fullscreenElement||document.webkitFullscreenElement}i(N,"getFullscreenElement");function z(h=!0){h?U(e.canvas):w()}i(z,"setFullscreen");function K(){return!!N()}i(K,"isFullscreen");function G(){e.stopped=!0;for(let h in de)e.canvas.removeEventListener(h,de[h]);for(let h in He)document.removeEventListener(h,He[h]);for(let h in be)window.removeEventListener(h,be[h]);st.disconnect()}i(G,"quit");function $(h){e.loopID!==null&&cancelAnimationFrame(e.loopID);let T=0,D=i(H=>{if(e.stopped)return;if(document.visibilityState!=="visible"){e.loopID=requestAnimationFrame(D);return}let ve=H/1e3,re=ve-e.realTime,Ke=t.maxFPS?1/t.maxFPS:0;e.realTime=ve,T+=re,T>Ke&&(e.skipTime||(e.dt=T,e.time+=n(),e.fpsCounter.tick(e.dt)),T=0,e.skipTime=!1,e.numFrames++,Dn(),h(),Mt()),e.loopID=requestAnimationFrame(D)},"frame");D(0)}i($,"run");function A(){return"ontouchstart"in window||navigator.maxTouchPoints>0}i(A,"isTouchscreen");function ne(){return e.mousePos.clone()}i(ne,"mousePos");function k(){return e.mouseDeltaPos.clone()}i(k,"mouseDeltaPos");function oe(h="left"){return e.mouseState.pressed.has(h)}i(oe,"isMousePressed");function J(h="left"){return e.mouseState.down.has(h)}i(J,"isMouseDown");function ie(h="left"){return e.mouseState.released.has(h)}i(ie,"isMouseReleased");function fe(){return e.isMouseMoved}i(fe,"isMouseMoved");function Ue(h){return h===void 0?e.keyState.pressed.size>0:e.keyState.pressed.has(h)}i(Ue,"isKeyPressed");function we(h){return h===void 0?e.keyState.pressedRepeat.size>0:e.keyState.pressedRepeat.has(h)}i(we,"isKeyPressedRepeat");function Ie(h){return h===void 0?e.keyState.down.size>0:e.keyState.down.has(h)}i(Ie,"isKeyDown");function Le(h){return h===void 0?e.keyState.released.size>0:e.keyState.released.has(h)}i(Le,"isKeyReleased");function Ee(h){return h===void 0?e.mergedGamepadState.buttonState.pressed.size>0:e.mergedGamepadState.buttonState.pressed.has(h)}i(Ee,"isGamepadButtonPressed");function je(h){return h===void 0?e.mergedGamepadState.buttonState.down.size>0:e.mergedGamepadState.buttonState.down.has(h)}i(je,"isGamepadButtonDown");function Ne(h){return h===void 0?e.mergedGamepadState.buttonState.released.size>0:e.mergedGamepadState.buttonState.released.has(h)}i(Ne,"isGamepadButtonReleased");function _e(h){return e.events.on("resize",h)}i(_e,"onResize");let ft=Fe(h=>e.events.on("keyDown",h),(h,T)=>e.events.on("keyDown",D=>D===h&&T(h))),Se=Fe(h=>e.events.on("keyPress",h),(h,T)=>e.events.on("keyPress",D=>D===h&&T(h))),Ve=Fe(h=>e.events.on("keyPressRepeat",h),(h,T)=>e.events.on("keyPressRepeat",D=>D===h&&T(h))),ze=Fe(h=>e.events.on("keyRelease",h),(h,T)=>e.events.on("keyRelease",D=>D===h&&T(h))),rt=Fe(h=>e.events.on("mouseDown",T=>h(T)),(h,T)=>e.events.on("mouseDown",D=>D===h&&T(D))),ot=Fe(h=>e.events.on("mousePress",T=>h(T)),(h,T)=>e.events.on("mousePress",D=>D===h&&T(D))),wt=Fe(h=>e.events.on("mouseRelease",T=>h(T)),(h,T)=>e.events.on("mouseRelease",D=>D===h&&T(D)));function Yt(h){return e.events.on("mouseMove",()=>h(ne(),k()))}i(Yt,"onMouseMove");function Xt(h){return e.events.on("charInput",h)}i(Xt,"onCharInput");function Sn(h){return e.events.on("touchStart",h)}i(Sn,"onTouchStart");function $t(h){return e.events.on("touchMove",h)}i($t,"onTouchMove");function An(h){return e.events.on("touchEnd",h)}i(An,"onTouchEnd");function On(h){return e.events.on("scroll",h)}i(On,"onScroll");function Wt(h){return e.events.on("hide",h)}i(Wt,"onHide");function Rn(h){return e.events.on("show",h)}i(Rn,"onShow");function Un(h,T){if(typeof h=="function")return e.events.on("gamepadButtonDown",h);if(typeof h=="string"&&typeof T=="function")return e.events.on("gamepadButtonDown",D=>D===h&&T(h))}i(Un,"onGamepadButtonDown");function Qt(h,T){if(typeof h=="function")return e.events.on("gamepadButtonPress",h);if(typeof h=="string"&&typeof T=="function")return e.events.on("gamepadButtonPress",D=>D===h&&T(h))}i(Qt,"onGamepadButtonPress");function Jt(h,T){if(typeof h=="function")return e.events.on("gamepadButtonRelease",h);if(typeof h=="string"&&typeof T=="function")return e.events.on("gamepadButtonRelease",D=>D===h&&T(h))}i(Jt,"onGamepadButtonRelease");function Vn(h,T){return e.events.on("gamepadStick",(D,H)=>D===h&&T(H))}i(Vn,"onGamepadStick");function Pt(h){e.events.on("gamepadConnect",h)}i(Pt,"onGamepadConnect");function Pn(h){e.events.on("gamepadDisconnect",h)}i(Pn,"onGamepadDisconnect");function Dt(h){return e.mergedGamepadState.stickState.get(h)||new C(0)}i(Dt,"getGamepadStick");function Pe(){return[...e.charInputted]}i(Pe,"charInputted");function Ct(){return[...e.gamepads]}i(Ct,"getGamepads");function Dn(){e.events.trigger("input"),e.keyState.down.forEach(h=>e.events.trigger("keyDown",h)),e.mouseState.down.forEach(h=>e.events.trigger("mouseDown",h)),le()}i(Dn,"processInput");function Mt(){e.keyState.update(),e.mouseState.update(),e.mergedGamepadState.buttonState.update(),e.mergedGamepadState.stickState.forEach((h,T)=>{e.mergedGamepadState.stickState.set(T,new C(0))}),e.charInputted=[],e.isMouseMoved=!1,e.gamepadStates.forEach(h=>{h.buttonState.update(),h.stickState.forEach((T,D)=>{h.stickState.set(D,new C(0))})})}i(Mt,"resetInput");function Zt(h){let T={index:h.index,isPressed:D=>e.gamepadStates.get(h.index).buttonState.pressed.has(D),isDown:D=>e.gamepadStates.get(h.index).buttonState.down.has(D),isReleased:D=>e.gamepadStates.get(h.index).buttonState.released.has(D),getStick:D=>e.gamepadStates.get(h.index).stickState.get(D)};return e.gamepads.push(T),e.gamepadStates.set(h.index,{buttonState:new Rt,stickState:new Map([["left",new C(0)],["right",new C(0)]])}),T}i(Zt,"registerGamepad");function Mn(h){e.gamepads=e.gamepads.filter(T=>T.index!==h.index),e.gamepadStates.delete(h.index)}i(Mn,"removeGamepad");function le(){for(let h of navigator.getGamepads())h&&!e.gamepadStates.has(h.index)&&Zt(h);for(let h of e.gamepads){let T=navigator.getGamepads()[h.index],H=(t.gamepads??{})[T.id]??cr[T.id]??cr.default,ve=e.gamepadStates.get(h.index);for(let re=0;re<T.buttons.length;re++)T.buttons[re].pressed?(ve.buttonState.down.has(H.buttons[re])||(e.mergedGamepadState.buttonState.press(H.buttons[re]),ve.buttonState.press(H.buttons[re]),e.events.trigger("gamepadButtonPress",H.buttons[re])),e.events.trigger("gamepadButtonDown",H.buttons[re])):ve.buttonState.down.has(H.buttons[re])&&(e.mergedGamepadState.buttonState.release(H.buttons[re]),ve.buttonState.release(H.buttons[re]),e.events.trigger("gamepadButtonRelease",H.buttons[re]));for(let re in H.sticks){let Ke=H.sticks[re],at=new C(T.axes[Ke.x],T.axes[Ke.y]);ve.stickState.set(re,at),e.mergedGamepadState.stickState.set(re,at),e.events.trigger("gamepadStick",re,at)}}}i(le,"processGamepad");let de={},He={},be={},Ae=t.pixelDensity||window.devicePixelRatio||1;de.mousemove=h=>{let T=new C(h.offsetX,h.offsetY),D=new C(h.movementX,h.movementY);if(K()){let H=e.canvas.width/Ae,ve=e.canvas.height/Ae,re=window.innerWidth,Ke=window.innerHeight,at=re/Ke,ct=H/ve;if(at>ct){let $e=Ke/ve,Et=(re-H*$e)/2;T.x=ht(h.offsetX-Et,0,H*$e,0,H),T.y=ht(h.offsetY,0,ve*$e,0,ve)}else{let $e=re/H,Et=(Ke-ve*$e)/2;T.x=ht(h.offsetX,0,H*$e,0,H),T.y=ht(h.offsetY-Et,0,ve*$e,0,ve)}}e.events.onOnce("input",()=>{e.isMouseMoved=!0,e.mousePos=T,e.mouseDeltaPos=D,e.events.trigger("mouseMove")})};let it=["left","middle","right","back","forward"];de.mousedown=h=>{e.events.onOnce("input",()=>{let T=it[h.button];T&&(e.mouseState.press(T),e.events.trigger("mousePress",T))})},de.mouseup=h=>{e.events.onOnce("input",()=>{let T=it[h.button];T&&(e.mouseState.release(T),e.events.trigger("mouseRelease",T))})};let Gt=new Set([" ","ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Tab"]),en={ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",ArrowDown:"down"," ":"space"};de.keydown=h=>{Gt.has(h.key)&&h.preventDefault(),e.events.onOnce("input",()=>{let T=en[h.key]||h.key.toLowerCase();T.length===1?(e.events.trigger("charInput",T),e.charInputted.push(T)):T==="space"&&(e.events.trigger("charInput"," "),e.charInputted.push(" ")),h.repeat?(e.keyState.pressRepeat(T),e.events.trigger("keyPressRepeat",T)):(e.keyState.press(T),e.events.trigger("keyPressRepeat",T),e.events.trigger("keyPress",T))})},de.keyup=h=>{e.events.onOnce("input",()=>{let T=en[h.key]||h.key.toLowerCase();e.keyState.release(T),e.events.trigger("keyRelease",T)})},de.touchstart=h=>{h.preventDefault(),e.events.onOnce("input",()=>{let T=[...h.changedTouches],D=e.canvas.getBoundingClientRect();t.touchToMouse!==!1&&(e.mousePos=new C(T[0].clientX-D.x,T[0].clientY-D.y),e.mouseState.press("left"),e.events.trigger("mousePress","left")),T.forEach(H=>{e.events.trigger("touchStart",new C(H.clientX-D.x,H.clientY-D.y),H)})})},de.touchmove=h=>{h.preventDefault(),e.events.onOnce("input",()=>{let T=[...h.changedTouches],D=e.canvas.getBoundingClientRect();if(t.touchToMouse!==!1){let H=e.mousePos;e.mousePos=new C(T[0].clientX-D.x,T[0].clientY-D.y),e.mouseDeltaPos=e.mousePos.sub(H),e.events.trigger("mouseMove")}T.forEach(H=>{e.events.trigger("touchMove",new C(H.clientX-D.x,H.clientY-D.y),H)})})},de.touchend=h=>{e.events.onOnce("input",()=>{let T=[...h.changedTouches],D=e.canvas.getBoundingClientRect();t.touchToMouse!==!1&&(e.mousePos=new C(T[0].clientX-D.x,T[0].clientY-D.y),e.mouseDeltaPos=new C(0,0),e.mouseState.release("left"),e.events.trigger("mouseRelease","left")),T.forEach(H=>{e.events.trigger("touchEnd",new C(H.clientX-D.x,H.clientY-D.y),H)})})},de.touchcancel=h=>{e.events.onOnce("input",()=>{let T=[...h.changedTouches],D=e.canvas.getBoundingClientRect();t.touchToMouse!==!1&&(e.mousePos=new C(T[0].clientX-D.x,T[0].clientY-D.y),e.mouseState.release("left"),e.events.trigger("mouseRelease","left")),T.forEach(H=>{e.events.trigger("touchEnd",new C(H.clientX-D.x,H.clientY-D.y),H)})})},de.wheel=h=>{h.preventDefault(),e.events.onOnce("input",()=>{e.events.trigger("scroll",new C(h.deltaX,h.deltaY))})},de.contextmenu=h=>h.preventDefault(),He.visibilitychange=()=>{document.visibilityState==="visible"?(e.skipTime=!0,e.isHidden=!1,e.events.trigger("show")):(e.isHidden=!0,e.events.trigger("hide"))},be.gamepadconnected=h=>{let T=Zt(h.gamepad);e.events.onOnce("input",()=>{e.events.trigger("gamepadConnect",T)})},be.gamepaddisconnected=h=>{let T=Ct().filter(D=>D.index===h.gamepad.index)[0];Mn(h.gamepad),e.events.onOnce("input",()=>{e.events.trigger("gamepadDisconnect",T)})};for(let h in de)e.canvas.addEventListener(h,de[h]);for(let h in He)document.addEventListener(h,He[h]);for(let h in be)window.addEventListener(h,be[h]);let st=new ResizeObserver(h=>{for(let T of h)if(T.target===e.canvas){if(e.lastWidth===e.canvas.offsetWidth&&e.lastHeight===e.canvas.offsetHeight)return;e.lastWidth=e.canvas.offsetWidth,e.lastHeight=e.canvas.offsetHeight,e.events.onOnce("input",()=>{e.events.trigger("resize")})}});return st.observe(e.canvas),{dt:n,time:a,run:$,canvas:e.canvas,fps:l,numFrames:c,quit:G,isHidden:o,setFullscreen:z,isFullscreen:K,setCursor:x,screenshot:f,getGamepads:Ct,getCursor:m,setCursorLocked:O,isCursorLocked:g,isTouchscreen:A,mousePos:ne,mouseDeltaPos:k,isKeyDown:Ie,isKeyPressed:Ue,isKeyPressedRepeat:we,isKeyReleased:Le,isMouseDown:J,isMousePressed:oe,isMouseReleased:ie,isMouseMoved:fe,isGamepadButtonPressed:Ee,isGamepadButtonDown:je,isGamepadButtonReleased:Ne,getGamepadStick:Dt,charInputted:Pe,onResize:_e,onKeyDown:ft,onKeyPress:Se,onKeyPressRepeat:Ve,onKeyRelease:ze,onMouseDown:rt,onMousePress:ot,onMouseRelease:wt,onMouseMove:Yt,onCharInput:Xt,onTouchStart:Sn,onTouchMove:$t,onTouchEnd:An,onScroll:On,onHide:Wt,onShow:Rn,onGamepadButtonDown:Un,onGamepadButtonPress:Qt,onGamepadButtonRelease:Jt,onGamepadStick:Vn,onGamepadConnect:Pt,onGamepadDisconnect:Pn,events:e.events}},"default");var qe=class t{static{i(this,"Texture")}ctx;src=null;glTex;width;height;constructor(e,n,o,a={}){this.ctx=e;let l=e.gl;this.glTex=e.gl.createTexture(),e.onDestroy(()=>this.free()),this.width=n,this.height=o;let c={linear:l.LINEAR,nearest:l.NEAREST}[a.filter??e.opts.texFilter]??l.NEAREST,f={repeat:l.REPEAT,clampToEadge:l.CLAMP_TO_EDGE}[a.wrap]??l.CLAMP_TO_EDGE;this.bind(),n&&o&&l.texImage2D(l.TEXTURE_2D,0,l.RGBA,n,o,0,l.RGBA,l.UNSIGNED_BYTE,null),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,c),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,c),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,f),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,f),this.unbind()}static fromImage(e,n,o={}){let a=new t(e,n.width,n.height,o);return a.update(n),a.src=n,a}update(e,n=0,o=0){let a=this.ctx.gl;this.bind(),a.texSubImage2D(a.TEXTURE_2D,0,n,o,a.RGBA,a.UNSIGNED_BYTE,e),this.unbind()}bind(){this.ctx.pushTexture2D(this.glTex)}unbind(){this.ctx.popTexture2D()}free(){this.ctx.gl.deleteTexture(this.glTex)}},yt=class{static{i(this,"FrameBuffer")}ctx;tex;glFramebuffer;glRenderbuffer;constructor(e,n,o,a={}){this.ctx=e;let l=e.gl;e.onDestroy(()=>this.free()),this.tex=new qe(e,n,o,a),this.glFramebuffer=l.createFramebuffer(),this.glRenderbuffer=l.createRenderbuffer(),this.bind(),l.renderbufferStorage(l.RENDERBUFFER,l.DEPTH_STENCIL,n,o),l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,this.tex.glTex,0),l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_STENCIL_ATTACHMENT,l.RENDERBUFFER,this.glRenderbuffer),this.unbind()}get width(){return this.tex.width}get height(){return this.tex.height}toImageData(){let e=this.ctx.gl,n=new Uint8ClampedArray(this.width*this.height*4);this.bind(),e.readPixels(0,0,this.width,this.height,e.RGBA,e.UNSIGNED_BYTE,n),this.unbind();let o=this.width*4,a=new Uint8Array(o);for(let l=0;l<(this.height/2|0);l++){let c=l*o,f=(this.height-l-1)*o;a.set(n.subarray(c,c+o)),n.copyWithin(c,f,f+o),n.set(a,f)}return new ImageData(n,this.width,this.height)}toDataURL(){let e=document.createElement("canvas"),n=e.getContext("2d");return e.width=this.width,e.height=this.height,n.putImageData(this.toImageData(),0,0),e.toDataURL()}clear(){let e=this.ctx.gl;e.clear(e.COLOR_BUFFER_BIT)}draw(e){this.bind(),e(),this.unbind()}bind(){this.ctx.pushFramebuffer(this.glFramebuffer),this.ctx.pushRenderbuffer(this.glRenderbuffer),this.ctx.pushViewport({x:0,y:0,w:this.width,h:this.height})}unbind(){this.ctx.popFramebuffer(),this.ctx.popRenderbuffer(),this.ctx.popViewport()}free(){let e=this.ctx.gl;e.deleteFramebuffer(this.glFramebuffer),e.deleteRenderbuffer(this.glRenderbuffer),this.tex.free()}},dn=class{static{i(this,"Shader")}ctx;glProgram;constructor(e,n,o,a){this.ctx=e,e.onDestroy(()=>this.free());let l=e.gl,c=l.createShader(l.VERTEX_SHADER),f=l.createShader(l.FRAGMENT_SHADER);l.shaderSource(c,n),l.shaderSource(f,o),l.compileShader(c),l.compileShader(f);let x=l.createProgram();if(this.glProgram=x,l.attachShader(x,c),l.attachShader(x,f),a.forEach((m,O)=>l.bindAttribLocation(x,O,m)),l.linkProgram(x),!l.getProgramParameter(x,l.LINK_STATUS)){let m=l.getShaderInfoLog(c);if(m)throw new Error("VERTEX SHADER "+m);let O=l.getShaderInfoLog(f);if(O)throw new Error("FRAGMENT SHADER "+O)}l.deleteShader(c),l.deleteShader(f)}bind(){this.ctx.pushProgram(this.glProgram)}unbind(){this.ctx.popProgram()}send(e){let n=this.ctx.gl;for(let o in e){let a=e[o],l=n.getUniformLocation(this.glProgram,o);if(typeof a=="number")n.uniform1f(l,a);else if(a instanceof Me)n.uniformMatrix4fv(l,!1,new Float32Array(a.m));else if(a instanceof Z)n.uniform3f(l,a.r,a.g,a.b);else if(a instanceof C)n.uniform2f(l,a.x,a.y);else if(Array.isArray(a)){let c=a[0];typeof c=="number"?n.uniform1fv(l,a):c instanceof C?n.uniform2fv(l,a.map(f=>[f.x,f.y]).flat()):c instanceof Z&&n.uniform3fv(l,a.map(f=>[f.r,f.g,f.b]).flat())}else throw new Error("Unsupported uniform data type")}}free(){this.ctx.gl.deleteProgram(this.glProgram)}},hn=class{static{i(this,"BatchRenderer")}ctx;glVBuf;glIBuf;vqueue=[];iqueue=[];stride;maxVertices;maxIndices;vertexFormat;numDraws=0;curPrimitive=null;curTex=null;curShader=null;curUniform={};constructor(e,n,o,a){let l=e.gl;this.vertexFormat=n,this.ctx=e,this.stride=n.reduce((c,f)=>c+f.size,0),this.maxVertices=o,this.maxIndices=a,this.glVBuf=l.createBuffer(),e.pushArrayBuffer(this.glVBuf),l.bufferData(l.ARRAY_BUFFER,o*4,l.DYNAMIC_DRAW),e.popArrayBuffer(),this.glIBuf=l.createBuffer(),e.pushElementArrayBuffer(this.glIBuf),l.bufferData(l.ELEMENT_ARRAY_BUFFER,a*4,l.DYNAMIC_DRAW),e.popElementArrayBuffer()}push(e,n,o,a,l=null,c={}){(e!==this.curPrimitive||l!==this.curTex||a!==this.curShader||!ln(this.curUniform,c)||this.vqueue.length+n.length*this.stride>this.maxVertices||this.iqueue.length+o.length>this.maxIndices)&&this.flush();let f=this.vqueue.length/this.stride;for(let x of n)this.vqueue.push(x);for(let x of o)this.iqueue.push(x+f);this.curPrimitive=e,this.curShader=a,this.curTex=l,this.curUniform=c}flush(){if(!this.curPrimitive||!this.curShader||this.vqueue.length===0||this.iqueue.length===0)return;let e=this.ctx.gl;this.ctx.pushArrayBuffer(this.glVBuf),e.bufferSubData(e.ARRAY_BUFFER,0,new Float32Array(this.vqueue)),this.ctx.pushElementArrayBuffer(this.glIBuf),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,new Uint16Array(this.iqueue)),this.ctx.setVertexFormat(this.vertexFormat),this.curShader.bind(),this.curShader.send(this.curUniform),this.curTex?.bind(),e.drawElements(this.curPrimitive,this.iqueue.length,e.UNSIGNED_SHORT,0),this.curTex?.unbind(),this.curShader.unbind(),this.ctx.popArrayBuffer(),this.ctx.popElementArrayBuffer(),this.vqueue=[],this.iqueue=[],this.numDraws++}free(){let e=this.ctx.gl;e.deleteBuffer(this.glVBuf),e.deleteBuffer(this.glIBuf)}};function xt(t){let e=[],n=i(l=>{e.push(l),t(l)},"push"),o=i(()=>{e.pop(),t(a()??null)},"pop"),a=i(()=>e[e.length-1],"cur");return[n,o,a]}i(xt,"genStack");function mr(t,e={}){let n=[];function o(k){n.push(k)}i(o,"onDestroy");function a(){n.forEach(k=>k()),t.getExtension("WEBGL_lose_context").loseContext()}i(a,"destroy");let l=null;function c(k){if(ln(k,l))return;l=k;let oe=k.reduce((J,ie)=>J+ie.size,0);k.reduce((J,ie,fe)=>(t.vertexAttribPointer(fe,ie.size,t.FLOAT,!1,oe*4,J),t.enableVertexAttribArray(fe),J+ie.size*4),0)}i(c,"setVertexFormat");let[f,x]=xt(k=>t.bindTexture(t.TEXTURE_2D,k)),[m,O]=xt(k=>t.bindBuffer(t.ARRAY_BUFFER,k)),[g,U]=xt(k=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,k)),[w,N]=xt(k=>t.bindFramebuffer(t.FRAMEBUFFER,k)),[z,K]=xt(k=>t.bindRenderbuffer(t.RENDERBUFFER,k)),[G,$]=xt(({x:k,y:oe,w:J,h:ie})=>{t.viewport(k,oe,J,ie)}),[A,ne]=xt(k=>t.useProgram(k));return G({x:0,y:0,w:t.drawingBufferWidth,h:t.drawingBufferHeight}),{gl:t,opts:e,onDestroy:o,destroy:a,pushTexture2D:f,popTexture2D:x,pushArrayBuffer:m,popArrayBuffer:O,pushElementArrayBuffer:g,popElementArrayBuffer:U,pushFramebuffer:w,popFramebuffer:N,pushRenderbuffer:z,popRenderbuffer:K,pushViewport:G,popViewport:$,pushProgram:A,popProgram:ne,setVertexFormat:c}}i(mr,"initGfx");var Re=class t{static{i(this,"Asset")}loaded=!1;data=null;error=null;onLoadEvents=new ye;onErrorEvents=new ye;onFinishEvents=new ye;constructor(e){e.then(n=>{this.loaded=!0,this.data=n,this.onLoadEvents.trigger(n)}).catch(n=>{if(this.error=n,this.onErrorEvents.numListeners()>0)this.onErrorEvents.trigger(n);else throw n}).finally(()=>{this.onFinishEvents.trigger(),this.loaded=!0})}static loaded(e){let n=new t(Promise.resolve(e));return n.data=e,n.loaded=!0,n}onLoad(e){return this.loaded&&this.data?e(this.data):this.onLoadEvents.add(e),this}onError(e){return this.loaded&&this.error?e(this.error):this.onErrorEvents.add(e),this}onFinish(e){return this.loaded?e():this.onFinishEvents.add(e),this}then(e){return this.onLoad(e)}catch(e){return this.onError(e)}finally(e){return this.onFinish(e)}},nt=class{static{i(this,"AssetBucket")}assets=new Map;lastUID=0;add(e,n){let o=e??this.lastUID+++"",a=new Re(n);return this.assets.set(o,a),a}addLoaded(e,n){let o=e??this.lastUID+++"",a=Re.loaded(n);return this.assets.set(o,a),a}get(e){return this.assets.get(e)}progress(){if(this.assets.size===0)return 1;let e=0;return this.assets.forEach(n=>{n.loaded&&e++}),e/this.assets.size}};function dr(t){return fetch(t).then(e=>{if(!e.ok)throw new Error(`Failed to fetch "${t}"`);return e})}i(dr,"fetchURL");function Nt(t){return dr(t).then(e=>e.json())}i(Nt,"fetchJSON");function io(t){return dr(t).then(e=>e.text())}i(io,"fetchText");function so(t){return dr(t).then(e=>e.arrayBuffer())}i(so,"fetchArrayBuffer");function _t(t){let e=new Image;return e.crossOrigin="anonymous",e.src=t,new Promise((n,o)=>{e.onload=()=>n(e),e.onerror=()=>o(new Error(`Failed to load image from "${t}"`))})}i(_t,"loadImg");var hr=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",Ut="topleft";var ao="monospace",Ht="monospace";var pn="linear";var fn=[{name:"a_pos",size:2},{name:"a_uv",size:2},{name:"a_color",size:4}],Hs=fn.reduce((t,e)=>t+e.size,0),co=2048,uo=co*4*Hs,lo=co*6,mo=`
attribute vec2 a_pos;
attribute vec2 a_uv;
attribute vec4 a_color;

varying vec2 v_pos;
varying vec2 v_uv;
varying vec4 v_color;

vec4 def_vert() {
	return vec4(a_pos, 0.0, 1.0);
}

{{user}}

void main() {
	vec4 pos = vert(a_pos, a_uv, a_color);
	v_pos = a_pos;
	v_uv = a_uv;
	v_color = a_color;
	gl_Position = pos;
}
`,ho=`
precision mediump float;

varying vec2 v_pos;
varying vec2 v_uv;
varying vec4 v_color;

uniform sampler2D u_tex;

vec4 def_frag() {
	return v_color * texture2D(u_tex, v_uv);
}

{{user}}

void main() {
	gl_FragColor = frag(v_pos, v_uv, v_color, u_tex);
	if (gl_FragColor.a == 0.0) {
		discard;
	}
}
`,gn=`
vec4 vert(vec2 pos, vec2 uv, vec4 color) {
	return def_vert();
}
`,bn=`
vec4 frag(vec2 pos, vec2 uv, vec4 color, sampler2D tex) {
	return def_frag();
}
`,po=new Set(["id","require"]),fo=new Set(["add","update","draw","destroy","inspect","drawInspect"]),pr=/\[(?<style>\w+)\](?<text>.*?)\[\/\k<style>\]/g,go=200,bo=640,vo=65536;var vn=2.5949095,xo=1.70158+1,yo=2*Math.PI/3,wo=2*Math.PI/4.5,xn={linear:t=>t,easeInSine:t=>1-Math.cos(t*Math.PI/2),easeOutSine:t=>Math.sin(t*Math.PI/2),easeInOutSine:t=>-(Math.cos(Math.PI*t)-1)/2,easeInQuad:t=>t*t,easeOutQuad:t=>1-(1-t)*(1-t),easeInOutQuad:t=>t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2,easeInCubic:t=>t*t*t,easeOutCubic:t=>1-Math.pow(1-t,3),easeInOutCubic:t=>t<.5?4*t*t*t:1-Math.pow(-2*t+2,3)/2,easeInQuart:t=>t*t*t*t,easeOutQuart:t=>1-Math.pow(1-t,4),easeInOutQuart:t=>t<.5?8*t*t*t*t:1-Math.pow(-2*t+2,4)/2,easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>1-Math.pow(1-t,5),easeInOutQuint:t=>t<.5?16*t*t*t*t*t:1-Math.pow(-2*t+2,5)/2,easeInExpo:t=>t===0?0:Math.pow(2,10*t-10),easeOutExpo:t=>t===1?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>t===0?0:t===1?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2,easeInCirc:t=>1-Math.sqrt(1-Math.pow(t,2)),easeOutCirc:t=>Math.sqrt(1-Math.pow(t-1,2)),easeInOutCirc:t=>t<.5?(1-Math.sqrt(1-Math.pow(2*t,2)))/2:(Math.sqrt(1-Math.pow(-2*t+2,2))+1)/2,easeInBack:t=>xo*t*t*t-1.70158*t*t,easeOutBack:t=>1+xo*Math.pow(t-1,3)+1.70158*Math.pow(t-1,2),easeInOutBack:t=>t<.5?Math.pow(2*t,2)*((vn+1)*2*t-vn)/2:(Math.pow(2*t-2,2)*((vn+1)*(t*2-2)+vn)+2)/2,easeInElastic:t=>t===0?0:t===1?1:-Math.pow(2,10*t-10)*Math.sin((t*10-10.75)*yo),easeOutElastic:t=>t===0?0:t===1?1:Math.pow(2,-10*t)*Math.sin((t*10-.75)*yo)+1,easeInOutElastic:t=>t===0?0:t===1?1:t<.5?-(Math.pow(2,20*t-10)*Math.sin((20*t-11.125)*wo))/2:Math.pow(2,-20*t+10)*Math.sin((20*t-11.125)*wo)/2+1,easeInBounce:t=>1-xn.easeOutBounce(1-t),easeOutBounce:t=>t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,easeInOutBounce:t=>t<.5?(1-xn.easeOutBounce(1-2*t))/2:(1+xn.easeOutBounce(2*t-1))/2},Vt=xn;var Kt=class{static{i(this,"TexPacker")}textures=[];bigTextures=[];canvas;c2d;x=0;y=0;curHeight=0;gfx;constructor(e,n,o){this.gfx=e,this.canvas=document.createElement("canvas"),this.canvas.width=n,this.canvas.height=o,this.textures=[qe.fromImage(e,this.canvas)],this.bigTextures=[],this.c2d=this.canvas.getContext("2d")}add(e){if(e.width>this.canvas.width||e.height>this.canvas.height){let a=qe.fromImage(this.gfx,e);return this.bigTextures.push(a),[a,new ue(0,0,1,1)]}this.x+e.width>this.canvas.width&&(this.x=0,this.y+=this.curHeight,this.curHeight=0),this.y+e.height>this.canvas.height&&(this.c2d.clearRect(0,0,this.canvas.width,this.canvas.height),this.textures.push(qe.fromImage(this.gfx,this.canvas)),this.x=0,this.y=0,this.curHeight=0);let n=this.textures[this.textures.length-1],o=new C(this.x,this.y);return this.x+=e.width,e.height>this.curHeight&&(this.curHeight=e.height),e instanceof ImageData?this.c2d.putImageData(e,o.x,o.y):this.c2d.drawImage(e,o.x,o.y),n.update(this.canvas),[n,new ue(o.x/this.canvas.width,o.y/this.canvas.height,e.width/this.canvas.width,e.height/this.canvas.height)]}free(){for(let e of this.textures)e.free();for(let e of this.bigTextures)e.free()}};function Ks(t){return{color:t.color,opacity:t.opacity,anchor:t.anchor,outline:t.outline,shader:t.shader,uniform:t.uniform}}i(Ks,"getRenderProps");function Co(t,e={}){let n=W(this);return{id:"circle",radius:t,draw(){n.drawCircle(Object.assign(Ks(this),{radius:this.radius,fill:e.fill}))},renderArea(){return new ae(new C(this.anchor?0:-this.radius),this.radius*2,this.radius*2)},inspect(){return`${Math.ceil(this.radius)}`}}}i(Co,"circle");function Eo(t){return{add(){this.canvas=t}}}i(Eo,"drawon");function To(t=1){let e=W(this),n,o=0,a=!1;return{require:["opacity"],add(){n=this.opacity,this.opacity=0},update(){a||(o+=e.dt(),this.opacity=e.map(o,0,t,0,n),o>=t&&(this.opacity=n,a=!0))}}}i(To,"fadeIn");function So(t="intersect"){return{id:"mask",mask:t}}i(So,"mask");function Ao(t){let e=W(this),n=pe(e);return{id:"opacity",opacity:t??1,inspect(){return`${n.toFixed(this.opacity,1)}`},fadeIn(o=1,a=e.easings.linear){return e.tween(0,this.opacity,o,l=>this.opacity=l,a)},fadeOut(o=1,a=e.easings.linear){return e.tween(this.opacity,0,o,l=>this.opacity=l,a)}}}i(Ao,"opacity");function Oo(t=1,e=te(0,0,0)){return{id:"outline",outline:{width:t,color:e}}}i(Oo,"outline");function Ro(t,e={}){let n=W(this),o=pe(n);if(t.length<3)throw new Error(`Polygon's need more than two points, ${t.length} points provided`);return{id:"polygon",pts:t,colors:e.colors,uv:e.uv,tex:e.tex,radius:e.radius,draw(){n.drawPolygon(Object.assign(o.getRenderProps(this),{pts:this.pts,colors:this.colors,uv:this.uv,tex:this.tex,radius:this.radius,fill:e.fill}))},renderArea(){return new Oe(this.pts)},inspect(){return this.pts.map(a=>`[${a.x},${a.y}]`).join(",")}}}i(Ro,"polygon");function Uo(t,e,n){let o=W(this),a;return o.get("area").forEach(c=>{if(n&&n.some(m=>c.is(m)))return;let x=c.worldArea().raycast(t,e);x&&(a?x.fraction<a.fraction&&(a=x,a.object=c):(a=x,a.object=c))}),a}i(Uo,"raycast");function Vo(t,e,n={}){let o=W(this),a=pe(o);return{id:"rect",width:t,height:e,radius:n.radius||0,draw(){o.drawRect(Object.assign(a.getRenderProps(this),{width:this.width,height:this.height,radius:this.radius,fill:n.fill}))},renderArea(){return new ae(E(0),this.width,this.height)},inspect(){return`${Math.ceil(this.width)}, ${Math.ceil(this.height)}`}}}i(Vo,"rect");function Po(t,e){return{id:"shader",shader:t,...typeof e=="function"?{uniform:e(),update(){this.uniform=e()}}:{uniform:e},inspect(){return`shader: ${t}`}}}i(Po,"shader");function yn(t,e={}){let n=W(this),o=pe(this),a=null,l=null,c=null,f=new ye;if(!t)throw new Error("Please pass the resource name or data to sprite()");let x=i((m,O,g,U)=>{let w=E(1,1);return g&&U?(w.x=g/(m.width*O.w),w.y=U/(m.height*O.h)):g?(w.x=g/(m.width*O.w),w.y=w.x):U&&(w.y=U/(m.height*O.h),w.x=w.y),w},"calcTexScale");return{id:"sprite",width:0,height:0,frame:e.frame||0,quad:e.quad||new ue(0,0,1,1),animSpeed:e.animSpeed??1,flipX:e.flipX??!1,flipY:e.flipY??!1,draw(){if(!a)return;let m=a.frames[this.frame??0];if(!m)throw new Error(`Frame not found: ${this.frame??0}`);if(a.slice9){let{left:O,right:g,top:U,bottom:w}=a.slice9,N=a.tex.width*m.w,z=a.tex.height*m.h,K=this.width-O-g,G=this.height-U-w,$=O/N,A=g/N,ne=1-$-A,k=U/z,oe=w/z,J=1-k-oe,ie=[he(0,0,$,k),he($,0,ne,k),he($+ne,0,A,k),he(0,k,$,J),he($,k,ne,J),he($+ne,k,A,J),he(0,k+J,$,oe),he($,k+J,ne,oe),he($+ne,k+J,A,oe),he(0,0,O,U),he(O,0,K,U),he(O+K,0,g,U),he(0,U,O,G),he(O,U,K,G),he(O+K,U,g,G),he(0,U+G,O,w),he(O,U+G,K,w),he(O+K,U+G,g,w)];for(let fe=0;fe<9;fe++){let Ue=ie[fe],we=ie[fe+9];o.drawTexture(Object.assign(o.getRenderProps(this),{pos:we.pos(),tex:a.tex,quad:m.scale(Ue),flipX:this.flipX,flipY:this.flipY,tiled:e.tiled,width:we.w,height:we.h}))}}else o.drawTexture(Object.assign(o.getRenderProps(this),{tex:a.tex,quad:m.scale(this.quad??new ue(0,0,1,1)),flipX:this.flipX,flipY:this.flipY,tiled:e.tiled,width:this.width,height:this.height}))},add(){let m=i(g=>{let U=g.frames[0].clone();e.quad&&(U=U.scale(e.quad));let w=x(g.tex,U,e.width,e.height);this.width=g.tex.width*U.w*w.x,this.height=g.tex.height*U.h*w.y,e.anim&&this.play(e.anim),a=g,f.trigger(a)},"setSpriteData"),O=o.resolveSprite(t);O?O.onLoad(m):n.onLoad(()=>m(o.resolveSprite(t).data))},update(){if(!l)return;let m=a.anims[l.name];if(typeof m=="number"){this.frame=m;return}if(m.speed===0)throw new Error("Sprite anim speed cannot be 0");l.timer+=n.dt()*this.animSpeed,l.timer>=1/l.speed&&(l.timer=0,this.frame+=c,(this.frame<Math.min(m.from,m.to)||this.frame>Math.max(m.from,m.to))&&(l.loop?l.pingpong?(this.frame-=c,c*=-1,this.frame+=c):this.frame=m.from:l.pingpong?c===Math.sign(m.to-m.from)?(this.frame=m.to,c*=-1,this.frame+=c):(this.frame=m.from,l.onEnd(),this.stop()):(this.frame=m.to,l.onEnd(),this.stop())))},play(m,O={}){if(!a){f.add(()=>this.play(m,O));return}let g=a.anims[m];if(g===void 0)throw new Error(`Anim not found: ${m}`);l&&this.stop(),l=typeof g=="number"?{name:m,timer:0,loop:!1,pingpong:!1,speed:0,onEnd:()=>{}}:{name:m,timer:0,loop:O.loop??g.loop??!1,pingpong:O.pingpong??g.pingpong??!1,speed:O.speed??g.speed??10,onEnd:O.onEnd??(()=>{})},c=typeof g=="number"?null:g.from<g.to?1:-1,this.frame=typeof g=="number"?g:g.from,this.trigger("animStart",m)},stop(){if(!l)return;let m=l.name;l=null,this.trigger("animEnd",m)},numFrames(){return a?.frames.length??0},curAnim(){return l?.name},onAnimEnd(m){return this.on("animEnd",m)},onAnimStart(m){return this.on("animStart",m)},renderArea(){return new n.Rect(E(0),this.width,this.height)},inspect(){if(typeof t=="string")return`"${t}"`}}}i(yn,"sprite");function Do(t,e={}){let n=W(this),o=pe(n);function a(c){let f=n.formatText(Object.assign(o.getRenderProps(c),{text:c.text+"",size:c.textSize,font:c.font,width:e.width&&c.width,align:c.align,letterSpacing:c.letterSpacing,lineSpacing:c.lineSpacing,transform:c.textTransform,styles:c.textStyles}));return e.width||(c.width=f.width/(c.scale?.x||1)),c.height=f.height/(c.scale?.y||1),f}i(a,"update");let l={id:"text",set text(c){t=c,a(this)},get text(){return t},textSize:e.size??36,font:e.font,width:e.width??0,height:0,align:e.align,lineSpacing:e.lineSpacing,letterSpacing:e.letterSpacing,textTransform:e.transform,textStyles:e.styles,add(){n.onLoad(()=>a(this))},draw(){n.drawFormattedText(a(this))},renderArea(){return new ae(E(0),this.width,this.height)}};return a(l),l}i(Do,"text");function Mo(t,e){let n=W(this),o=pe(n);return{id:"rect",width:t,height:e,draw(){n.drawUVQuad(Object.assign(o.getRenderProps(this),{width:this.width,height:this.height}))},renderArea(){return new ae(E(0),this.width,this.height)},inspect(){return`${Math.ceil(this.width)}, ${Math.ceil(this.height)}`}}}i(Mo,"uvquad");function Go(t={}){let e=null,n=null,o=null,a=null;return{id:"agent",require:["pos","tile"],agentSpeed:t.speed??100,allowDiagonals:t.allowDiagonals??!0,getDistanceToTarget(){return e?this.pos.dist(e):0},getNextLocation(){return n&&o?n[o]:null},getPath(){return n?n.slice():null},getTarget(){return e},isNavigationFinished(){return n?o===null:!0},isTargetReachable(){return n!==null},isTargetReached(){return e?this.pos.eq(e):!0},setTarget(l){e=l,n=this.getLevel().getPath(this.pos,e,{allowDiagonals:this.allowDiagonals}),o=n?0:null,n?(a||(a=this.getLevel().onNavigationMapChanged(()=>{n&&o!==null&&(n=this.getLevel().getPath(this.pos,e,{allowDiagonals:this.allowDiagonals}),o=n?0:null,n?this.trigger("navigation-next",this,n[o]):this.trigger("navigation-ended",this))}),this.onDestroy(()=>a.cancel())),this.trigger("navigation-started",this),this.trigger("navigation-next",this,n[o])):this.trigger("navigation-ended",this)},update(){if(n&&o!==null){if(this.pos.sdist(n[o])<2)if(o===n.length-1){this.pos=e.clone(),o=null,this.trigger("navigation-ended",this),this.trigger("target-reached",this);return}else o++,this.trigger("navigation-next",this,n[o]);this.moveTo(n[o],this.agentSpeed)}},onNavigationStarted(l){return this.on("navigation-started",l)},onNavigationNext(l){return this.on("navigation-next",l)},onNavigationEnded(l){return this.on("navigation-ended",l)},onTargetReached(l){return this.on("target-reached",l)},inspect(){return JSON.stringify({target:JSON.stringify(e),path:JSON.stringify(n)})}}}i(Go,"agent");var Sc=kaboom;function fr(t={}){let e=E(0),n=t.isObstacle??!1,o=t.cost??0,a=t.edges??[],l=i(()=>{let f={left:1,top:2,right:4,bottom:8};return a.map(x=>f[x]||0).reduce((x,m)=>x|m,0)},"getEdgeMask"),c=l();return{id:"tile",tilePosOffset:t.offset??E(0),set tilePos(f){let x=this.getLevel();e=f.clone(),this.pos=E(this.tilePos.x*x.tileWidth(),this.tilePos.y*x.tileHeight()).add(this.tilePosOffset)},get tilePos(){return e},set isObstacle(f){n!==f&&(n=f,this.getLevel().invalidateNavigationMap())},get isObstacle(){return n},set cost(f){o!==f&&(o=f,this.getLevel().invalidateNavigationMap())},get cost(){return o},set edges(f){a=f,c=l(),this.getLevel().invalidateNavigationMap()},get edges(){return a},get edgeMask(){return c},getLevel(){return this.parent},moveLeft(){this.tilePos=this.tilePos.add(E(-1,0))},moveRight(){this.tilePos=this.tilePos.add(E(1,0))},moveUp(){this.tilePos=this.tilePos.add(E(0,-1))},moveDown(){this.tilePos=this.tilePos.add(E(0,1))}}}i(fr,"tile");function Bo(t,e){if(t==null)throw new Error("health() requires the initial amount of hp");return{id:"health",hurt(n=1){this.setHP(t-n),this.trigger("hurt",n)},heal(n=1){let o=t;this.setHP(t+n),this.trigger("heal",t-o)},hp(){return t},maxHP(){return e??null},setMaxHP(n){e=n},setHP(n){t=e?Math.min(e,n):n,t<=0&&this.trigger("death")},onHurt(n){return this.on("hurt",n)},onHeal(n){return this.on("heal",n)},onDeath(n){return this.on("death",n)},inspect(){return`${t}`}}}i(Bo,"health");function Fo(t,e={}){let n=W(this);if(t==null)throw new Error("lifespan() requires time");let o=e.fade??0;return{id:"lifespan",require:["opacity"],async add(){await n.wait(t),this.opacity=this.opacity??1,o>0&&await n.tween(this.opacity,0,o,a=>this.opacity=a,Vt.linear),this.destroy()}}}i(Fo,"lifespan");function Io(t,e,n){if(!t)throw new Error("state() requires an initial state");let o={};function a(x){o[x]||(o[x]={enter:new ye,end:new ye,update:new ye,draw:new ye})}i(a,"initStateEvents");function l(x,m,O){return a(m),o[m][x].add(O)}i(l,"on");function c(x,m,...O){a(m),o[m][x].trigger(...O)}i(c,"trigger");let f=!1;return{id:"state",state:t,enterState(x,...m){if(f=!0,e&&!e.includes(x))throw new Error(`State not found: ${x}`);let O=this.state;if(n){if(!n?.[O])return;let g=typeof n[O]=="string"?[n[O]]:n[O];if(!g.includes(x))throw new Error(`Cannot transition state from "${O}" to "${x}". Available transitions: ${g.map(U=>`"${U}"`).join(", ")}`)}c("end",O,...m),this.state=x,c("enter",x,...m),c("enter",`${O} -> ${x}`,...m)},onStateTransition(x,m,O){return l("enter",`${x} -> ${m}`,O)},onStateEnter(x,m){return l("enter",x,m)},onStateUpdate(x,m){return l("update",x,m)},onStateDraw(x,m){return l("draw",x,m)},onStateEnd(x,m){return l("end",x,m)},update(){f||(c("enter",t),f=!0),c("update",this.state)},draw(){c("draw",this.state)},inspect(){return this.state}}}i(Io,"state");function gr(t){return{id:"stay",stay:!0,scenesToStay:t}}i(gr,"stay");function wn(){return{id:"timer",wait(t,e){let n=W(this),o=[];e&&o.push(e);let a=0,l=this.onUpdate(()=>{a+=n.dt(),a>=t&&(o.forEach(c=>c()),l.cancel())});return{get paused(){return l.paused},set paused(c){l.paused=c},cancel:l.cancel,onEnd(c){o.push(c)},then(c){return this.onEnd(c),this}}},loop(t,e){let n=null,o=i(()=>{n=this.wait(t,o),e()},"newAction");return n=this.wait(0,o),{get paused(){return n.paused},set paused(a){n.paused=a},cancel:()=>n.cancel()}},tween(t,e,n,o,a=Vt.linear){let l=W(this),c=0,f=[],x=this.onUpdate(()=>{c+=l.dt();let m=Math.min(c/n,1);o(Je(t,e,a(m))),m===1&&(x.cancel(),o(e),f.forEach(O=>O()))});return{get paused(){return x.paused},set paused(m){x.paused=m},onEnd(m){f.push(m)},then(m){return this.onEnd(m),this},cancel(){x.cancel()},finish(){x.cancel(),o(e),f.forEach(m=>m())}}}}}i(wn,"timer");function Lo(t={}){let e=W(this),n=pe(e),{app:o}=n,a={},l=new Set;return{id:"area",collisionIgnore:t.collisionIgnore??[],add(){this.area.cursor&&this.onHover(()=>o.setCursor(this.area.cursor)),this.onCollideUpdate((c,f)=>{a[c.id]||this.trigger("collide",c,f),a[c.id]=f,l.add(c.id)})},update(){for(let c in a)l.has(Number(c))||(this.trigger("collideEnd",a[c].target),delete a[c]);l.clear()},drawInspect(){let c=this.localArea();e.pushTransform(),e.pushScale(this.area.scale),e.pushTranslate(this.area.offset);let f={outline:{width:4/n.getViewportScale(),color:te(0,0,255)},anchor:this.anchor,fill:!1,fixed:n.isFixed(this)};c instanceof e.Rect?e.drawRect({...f,pos:c.pos,width:c.width,height:c.height}):c instanceof e.Polygon?e.drawPolygon({...f,pts:c.pts}):c instanceof e.Circle&&e.drawCircle({...f,pos:c.center,radius:c.radius}),e.popTransform()},area:{shape:t.shape??null,scale:t.scale?E(t.scale):E(1),offset:t.offset??E(0),cursor:t.cursor??null},isClicked(){return o.isMousePressed()&&this.isHovering()},isHovering(){let c=n.isFixed(this)?e.mousePos():e.toWorld(e.mousePos());return this.hasPoint(c)},checkCollision(c){return a[c.id]??null},getCollisions(){return Object.values(a)},isColliding(c){return!!a[c.id]},isOverlapping(c){let f=a[c.id];return f&&f.hasOverlap()},onClick(c,f="left"){let x=o.onMousePress(f,()=>{this.isHovering()&&c()});return this.onDestroy(()=>x.cancel()),x},onHover(c){let f=!1;return this.onUpdate(()=>{f?f=this.isHovering():this.isHovering()&&(f=!0,c())})},onHoverUpdate(c){return this.onUpdate(()=>{this.isHovering()&&c()})},onHoverEnd(c){let f=!1;return this.onUpdate(()=>{f?this.isHovering()||(f=!1,c()):f=this.isHovering()})},onCollide(c,f){if(typeof c=="function"&&f===void 0)return this.on("collide",c);if(typeof c=="string")return this.onCollide((x,m)=>{x.is(c)&&f(x,m)})},onCollideUpdate(c,f){if(typeof c=="function"&&f===void 0)return this.on("collideUpdate",c);if(typeof c=="string")return this.on("collideUpdate",(x,m)=>x.is(c)&&f(x,m))},onCollideEnd(c,f){if(typeof c=="function"&&f===void 0)return this.on("collideEnd",c);if(typeof c=="string")return this.on("collideEnd",x=>x.is(c)&&f(x))},hasPoint(c){return dt(this.worldArea(),c)},resolveCollision(c){let f=this.checkCollision(c);f&&!f.resolved&&(this.pos=this.pos.add(f.displacement),f.resolved=!0)},localArea(){return this.area.shape?this.area.shape:this.renderArea()},worldArea(){let c=this.localArea();if(!(c instanceof e.Polygon||c instanceof e.Rect))throw new Error("Only support polygon and rect shapes for now");let f=this.transform.clone().scale(E(this.area.scale??1)).translate(this.area.offset);if(c instanceof e.Rect){let x=pt(this.anchor||Ut).add(1,1).scale(-.5).scale(c.width,c.height);f.translate(x)}return c.transform(f)},screenArea(){let c=this.worldArea();return n.isFixed(this)?c:c.transform(n.game.cam.transform)},inspect(){return`(${this.area.scale.x.toFixed(1)}, ${this.area.scale.y.toFixed(1)})`}}}i(Lo,"area");function ko(t={}){let e=W(this),n=pe(e),o=null,a=null,l=!1;return{id:"body",require:["pos"],vel:E(0),drag:t.drag??0,jumpForce:t.jumpForce??bo,gravityScale:t.gravityScale??1,isStatic:t.isStatic??!1,mass:t.mass??1,add(){if(this.mass===0)throw new Error("Can't set body mass to 0");this.is("area")&&(this.onCollideUpdate((c,f)=>{if(!c.is("body")||f.resolved)return;this.trigger("beforePhysicsResolve",f);let x=f.reverse();if(c.trigger("beforePhysicsResolve",x),!(f.resolved||x.resolved)&&!(this.isStatic&&c.isStatic)){if(!this.isStatic&&!c.isStatic){let m=this.mass+c.mass;this.pos=this.pos.add(f.displacement.scale(c.mass/m)),c.pos=c.pos.add(f.displacement.scale(-this.mass/m)),this.transform=n.calcTransform(this),c.transform=n.calcTransform(c)}else{let m=!this.isStatic&&c.isStatic?f:f.reverse();m.source.pos=m.source.pos.add(m.displacement),m.source.transform=n.calcTransform(m.source)}f.resolved=!0,this.trigger("physicsResolve",f),c.trigger("physicsResolve",f.reverse())}}),this.onPhysicsResolve(c=>{n.game.gravity&&(c.isBottom()&&this.isFalling()?(this.vel=this.vel.reject(n.game.gravity.unit()),o=c.target,a=c.target.pos,l?l=!1:this.trigger("ground",o)):c.isTop()&&this.isJumping()&&(this.vel=this.vel.reject(n.game.gravity.unit()),this.trigger("headbutt",c.target)))}))},update(){if(n.game.gravity&&!this.isStatic){l&&(o=null,a=null,this.trigger("fallOff"),l=!1);let c=!0;if(o&&(!this.isColliding(o)||!o.exists()||!o.is("body")?l=!0:(!o.pos.eq(a)&&t.stickToPlatform!==!1&&this.moveBy(o.pos.sub(a)),a=o.pos,c=!1)),c){let f=this.vel.clone();this.vel=this.vel.add(n.game.gravity.scale(this.gravityScale*e.dt()));let x=t.maxVelocity??vo;this.vel.slen()>x*x&&(this.vel=this.vel.unit().scale(x)),f.dot(n.game.gravity)<0&&this.vel.dot(n.game.gravity)>=0&&this.trigger("fall")}}this.vel.x*=1-this.drag,this.vel.y*=1-this.drag,this.move(this.vel)},onPhysicsResolve(c){return this.on("physicsResolve",c)},onBeforePhysicsResolve(c){return this.on("beforePhysicsResolve",c)},curPlatform(){return o},isGrounded(){return o!==null},isFalling(){return this.vel.dot(n.game.gravity)>0},isJumping(){return this.vel.dot(n.game.gravity)<0},jump(c){o=null,a=null,this.vel=n.game.gravity.unit().scale(-c||-this.jumpForce)},onGround(c){return this.on("ground",c)},onFall(c){return this.on("fall",c)},onFallOff(c){return this.on("fallOff",c)},onHeadbutt(c){return this.on("headbutt",c)}}}i(ko,"body");function jo(t=2){let e=t;return{id:"doubleJump",require:["body"],numJumps:t,add(){this.onGround(()=>{e=this.numJumps})},doubleJump(n){e<=0||(e<this.numJumps&&this.trigger("doubleJump"),e--,this.jump(n))},onDoubleJump(n){return this.on("doubleJump",n)},inspect(){return`${e}`}}}i(jo,"doubleJump");function Cn(t){if(!t)throw new Error("Please define an anchor");return{id:"anchor",anchor:t,inspect(){return typeof this.anchor=="string"?this.anchor:this.anchor.toString()}}}i(Cn,"anchor");function No(){return{id:"fixed",fixed:!0}}i(No,"fixed");function _o(t,e){return{id:"follow",require:["pos"],follow:{obj:t,offset:e??E(0)},add(){t.exists()&&(this.pos=this.follow.obj.pos.add(this.follow.offset))},update(){t.exists()&&(this.pos=this.follow.obj.pos.add(this.follow.offset))}}}i(_o,"follow");function Ho(t,e){let n=typeof t=="number"?C.fromAngle(t):t.unit();return{id:"move",require:["pos"],update(){this.move(n.scale(e))}}}i(Ho,"move");function Ko(t={}){let e=W(this),n=t.distance??go,o=!1;return{id:"offscreen",require:["pos"],isOffScreen(){let a=this.screenPos(),l=new ae(E(0),e.width(),e.height());return!e.testRectPoint(l,a)&&l.sdistToPoint(a)>n*n},onExitScreen(a){return this.on("exitView",a)},onEnterScreen(a){return this.on("enterView",a)},update(){this.isOffScreen()?(o||(this.trigger("exitView"),o=!0),t.hide&&(this.hidden=!0),t.pause&&(this.paused=!0),t.destroy&&this.destroy()):(o&&(this.trigger("enterView"),o=!1),t.hide&&(this.hidden=!1),t.pause&&(this.paused=!1))}}}i(Ko,"offscreen");function qo(t){return t.fixed?!0:t.parent?qo(t.parent):!1}i(qo,"isFixed");function qt(...t){let e=W(this),n=pe(e);return{id:"pos",pos:E(...t),moveBy(...o){this.pos=this.pos.add(E(...o))},move(...o){this.moveBy(E(...o).scale(e.dt()))},moveTo(...o){if(typeof o[0]=="number"&&typeof o[1]=="number")return this.moveTo(E(o[0],o[1]),o[2]);let a=o[0],l=o[1];if(l===void 0){this.pos=E(a);return}let c=a.sub(this.pos);if(c.len()<=l*e.dt()){this.pos=E(a);return}this.move(c.unit().scale(l))},worldPos(){return this.parent?this.parent.transform.multVec2(this.pos):this.pos},screenPos(){let o=this.worldPos();return qo(this)?o:e.toScreen(o)},inspect(){return`(${Math.round(this.pos.x)}, ${Math.round(this.pos.y)})`},drawInspect(){e.drawCircle({color:e.rgb(255,0,0),radius:4/n.getViewportScale()})}}}i(qt,"pos");function zo(t){return{id:"rotate",angle:t??0,rotateBy(e){this.angle+=e},rotateTo(e){this.angle=e},inspect(){return`${Math.round(this.angle)}`}}}i(zo,"rotate");function zt(...t){let e=W(this),n=pe(e);return t.length===0?zt(1):{id:"scale",scale:E(...t),scaleTo(...o){this.scale=E(...o)},scaleBy(...o){this.scale.scale(E(...o))},inspect(){return`(${n.toFixed(this.scale.x,2)}, ${n.toFixed(this.scale.y,2)})`}}}i(zt,"scale");function Yo(t){return{id:"z",z:t,inspect(){return`${this.z}`}}}i(Yo,"z");var Xo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAA1CAYAAADyMeOEAAAAAXNSR0IArs4c6QAAAoVJREFUaIHdm7txwkAQhheGAqACiCHzOKQDQrqgILpwSAeEDBnEUAF0gCMxZ7G72qce/mec2Lpf9+3unaS78wgSNZ8uX5729+d1FNWXUuGmXlBOUUEIMckEpeQJgBu6C+BSFngztBR2vd+ovY+7g+p6LbgaWgJrAeUkDYIUXgXdBBwNi6kpABJwMTQH3AZsXRR8GHTfgEth8E3gjdAUcNewpbTgY85sCMCUuOokozE0YM0YRzM9NGAAXd8+omAF5h4lnmBRvpSnZHyLoLEbaN+aKB9KWv/KWw0tAbbANnlG+UvB2dm77NxxdwgBpjrF/d7rW9cbmpvio2A5z8iAYpVU8pGZlo6/2+MSco2lHfd3rv9jAP038e1xef9o2mjvYb2OqpqKE81028/jeietlSEVO5FRWsxWsJit1G3aFpW8iWe5RwpiCZAk25QvV6nz6fIlynRGuTd5WqpJ4guAlDfVKBK87hXljflgv1ON6fV+4+5gVlA17SfeG0heKqQd4l4jI/wrmaA9N9R4ar+wpHJDZyrrfcH0nB66PqAzPi76pn+faSyJk/vzOorYhGurQrzj/P68jtBMawHaHBIR9xoD5O34dy0qQOSYHvqExq2TpT2nf76+w7y251OYF0CRaU+J920TwLUa6inx6OxE6g80lu2ux7Y2eJLF/rCXE6zEPdnenk9o+4ih9AEdnW2q81HXl5LuU6OTl2fXUhqganbXAGq3g6jJOWV/OnoesO6YqqEB/GdNsjf7uHtwj2DzmRNpp7iOZfm6D9oAxB6Yi1gC4oIYeo4MIPdopEQRB+cAko5J1tW386HpB2Kz1eop4Epdwls/kgZ1sh8gZsEjdcWkr//D8Qu3Z3l5Nl1NtAAAAABJRU5ErkJggg==";var $o="data:image/png;base64,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";var Wo=Dr("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L5QNSqT5iiySS9Ja2SV//5ME0ak//+4KgAAABgQBAADAMDgYCAEgCteQ0fZH6+ICXA357+MPfhR/+ywRf/U///LVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+5JknQAFoWhGLm5gBClBmT3GiAAAAAGkHAAAIAAANIOAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV");var Qo="data:image/png;base64,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";var Zs="3001.0.0";function pt(t){switch(t){case"topleft":return new C(-1,-1);case"top":return new C(0,-1);case"topright":return new C(1,-1);case"left":return new C(-1,0);case"center":return new C(0,0);case"right":return new C(1,0);case"botleft":return new C(-1,1);case"bot":return new C(0,1);case"botright":return new C(1,1);default:return t}}i(pt,"anchorPt");function ea(t){switch(t){case"left":return 0;case"center":return .5;case"right":return 1;default:return 0}}i(ea,"alignPt");function ta(t){return t.createBuffer(1,1,44100)}i(ta,"createEmptyAudioBuffer");var Xe,oi=i(t=>t&&t.loadAseprite,"isKaboomCtx"),W=i(t=>{if(!Xe)throw new Error("You are trying to access to Kaboom Context before their initialization.");return oi(t)?t:Xe},"getKaboomContext"),pe=i(t=>t._k,"getInternalContext"),na=i((t={})=>{let e=t.root??document.body;e===document.body&&(document.body.style.width="100%",document.body.style.height="100%",document.body.style.margin="0px",document.documentElement.style.width="100%",document.documentElement.style.height="100%");let n=t.canvas??e.appendChild(document.createElement("canvas")),o=t.scale??1,a=t.width&&t.height&&!t.stretch&&!t.letterbox;a?(n.width=t.width*o,n.height=t.height*o):(n.width=n.parentElement.offsetWidth,n.height=n.parentElement.offsetHeight);let l=["outline: none","cursor: default"];if(a){let r=n.width,s=n.height;l.push(`width: ${r}px`),l.push(`height: ${s}px`)}else l.push("width: 100%"),l.push("height: 100%");t.crisp&&(l.push("image-rendering: pixelated"),l.push("image-rendering: crisp-edges")),n.style.cssText=l.join(";");let c=t.pixelDensity||window.devicePixelRatio;n.width*=c,n.height*=c,n.tabIndex=0;let f=document.createElement("canvas");f.width=256,f.height=256;let x=f.getContext("2d",{willReadFrequently:!0}),m=oo({canvas:n,touchToMouse:t.touchToMouse,gamepads:t.gamepads,pixelDensity:t.pixelDensity,maxFPS:t.maxFPS}),O=[],g=m.canvas.getContext("webgl",{antialias:!0,depth:!0,stencil:!0,alpha:!0,preserveDrawingBuffer:!0}),U=mr(g,{texFilter:t.texFilter}),w=(()=>{let r=Pt(gn,bn),s=qe.fromImage(U,new ImageData(new Uint8ClampedArray([255,255,255,255]),1,1)),u=t.width&&t.height?new yt(U,t.width*c*o,t.height*c*o):new yt(U,g.drawingBufferWidth,g.drawingBufferHeight),p=null,d=1;t.background&&(p=te(t.background),d=Array.isArray(t.background)?t.background[3]:1,g.clearColor(p.r/255,p.g/255,p.b/255,d??1)),g.enable(g.BLEND),g.blendFuncSeparate(g.SRC_ALPHA,g.ONE_MINUS_SRC_ALPHA,g.ONE,g.ONE_MINUS_SRC_ALPHA);let v=new hn(U,fn,uo,lo),y=qe.fromImage(U,new ImageData(new Uint8ClampedArray([128,128,128,255,190,190,190,255,190,190,190,255,128,128,128,255]),2,2),{wrap:"repeat",filter:"nearest"});return{lastDrawCalls:0,defShader:r,defTex:s,frameBuffer:u,postShader:null,postShaderUniform:null,renderer:v,transform:new Me,transformStack:[],bgTex:y,bgColor:p,bgAlpha:d,width:t.width??g.drawingBufferWidth/c/o,height:t.height??g.drawingBufferHeight/c/o,viewport:{x:0,y:0,width:g.drawingBufferWidth,height:g.drawingBufferHeight},fixed:!1}})();class N{static{i(this,"SpriteData")}tex;frames=[new ue(0,0,1,1)];anims={};slice9=null;constructor(s,u,p={},d=null){this.tex=s,u&&(this.frames=u),this.anims=p,this.slice9=d}get width(){return this.tex.width*this.frames[0].w}get height(){return this.tex.height*this.frames[0].h}static from(s,u={}){return typeof s=="string"?N.fromURL(s,u):Promise.resolve(N.fromImage(s,u))}static fromImage(s,u={}){let[p,d]=G.packer.add(s),v=u.frames?u.frames.map(y=>new ue(d.x+y.x*d.w,d.y+y.y*d.h,y.w*d.w,y.h*d.h)):we(u.sliceX||1,u.sliceY||1,d.x,d.y,d.w,d.h);return new N(p,v,u.anims,u.slice9)}static fromURL(s,u={}){return _t(s).then(p=>N.fromImage(p,u))}}class z{static{i(this,"SoundData")}buf;constructor(s){this.buf=s}static fromArrayBuffer(s){return new Promise((u,p)=>K.ctx.decodeAudioData(s,u,p)).then(u=>new z(u))}static fromURL(s){return sr(s)?z.fromArrayBuffer(Jr(s)):so(s).then(u=>z.fromArrayBuffer(u))}}let K=(()=>{let r=new(window.AudioContext||window.webkitAudioContext),s=r.createGain();s.connect(r.destination);let u=new z(ta(r));return r.decodeAudioData(Wo.buffer.slice(0)).then(p=>{u.buf=p}).catch(p=>{console.error("Failed to load burp: ",p)}),{ctx:r,masterNode:s,burpSnd:u}})(),G={urlPrefix:"",sprites:new nt,fonts:new nt,bitmapFonts:new nt,sounds:new nt,shaders:new nt,custom:new nt,music:{},packer:new Kt(U,2048,2048),loaded:!1};function $(r){return typeof r!="string"||sr(r)?r:G.urlPrefix+r}i($,"fixURL");let A={events:new tt,objEvents:new tt,root:Fn([]),gravity:E(0,1),scenes:{},currentScene:null,logs:[],cam:{pos:null,scale:new C(1),angle:0,shake:0,transform:new Me}};A.root.use(wn());function ne(r){return G.custom.add(null,r)}i(ne,"load");function k(){let r=[G.sprites,G.sounds,G.shaders,G.fonts,G.bitmapFonts,G.custom];return r.reduce((s,u)=>s+u.progress(),0)/r.length}i(k,"loadProgress");function oe(r){return r!==void 0&&(G.urlPrefix=r),G.urlPrefix}i(oe,"loadRoot");function J(r,s){return G.custom.add(r,Nt(s))}i(J,"loadJSON");class ie{static{i(this,"FontData")}fontface;filter=pn;outline=null;size=64;constructor(s,u={}){if(this.fontface=s,this.filter=u.filter??pn,this.size=u.size??64,this.size>256)throw new Error(`Max font size: ${256}`);u.outline&&(this.outline={width:1,color:te(0,0,0)},typeof u.outline=="number"?this.outline.width=u.outline:typeof u.outline=="object"&&(u.outline.width&&(this.outline.width=u.outline.width),u.outline.color&&(this.outline.color=u.outline.color)))}}function fe(r,s,u={}){let p=new FontFace(r,typeof s=="string"?`url(${s})`:s);return document.fonts.add(p),G.fonts.add(r,p.load().catch(d=>{throw new Error(`Failed to load font from "${s}": ${d}`)}).then(d=>new ie(d,u)))}i(fe,"loadFont");function Ue(r,s,u,p,d={}){return G.bitmapFonts.add(r,_t(s).then(v=>Pn(qe.fromImage(U,v,d),u,p,d.chars??hr)))}i(Ue,"loadBitmapFont");function we(r=1,s=1,u=0,p=0,d=1,v=1){let y=[],P=d/r,V=v/s;for(let b=0;b<s;b++)for(let R=0;R<r;R++)y.push(new ue(u+R*P,p+b*V,P,V));return y}i(we,"slice");function Ie(r,s){return r=$(r),ne(typeof s=="string"?new Promise((u,p)=>{Nt(s).then(d=>{Ie(r,d).then(u).catch(p)})}):N.from(r).then(u=>{let p={};for(let d in s){let v=s[d],y=u.frames[0],P=2048*y.w,V=2048*y.h,b=v.frames?v.frames.map(L=>new ue(y.x+(v.x+L.x)/P*y.w,y.y+(v.y+L.y)/V*y.h,L.w/P*y.w,L.h/V*y.h)):we(v.sliceX||1,v.sliceY||1,y.x+v.x/P*y.w,y.y+v.y/V*y.h,v.width/P*y.w,v.height/V*y.h),R=new N(u.tex,b,v.anims);G.sprites.addLoaded(d,R),p[d]=R}return p}))}i(Ie,"loadSpriteAtlas");function Le(r,s={}){let u=document.createElement("canvas"),p=r[0].width,d=r[0].height;u.width=p*r.length,u.height=d;let v=u.getContext("2d");r.forEach((P,V)=>{P instanceof ImageData?v.putImageData(P,V*p,0):v.drawImage(P,V*p,0)});let y=v.getImageData(0,0,r.length*p,d);return N.fromImage(y,{...s,sliceX:r.length,sliceY:1})}i(Le,"createSpriteSheet");function Ee(r,s,u={sliceX:1,sliceY:1,anims:{}}){return s=$(s),Array.isArray(s)?s.some(p=>typeof p=="string")?G.sprites.add(r,Promise.all(s.map(p=>typeof p=="string"?_t(p):Promise.resolve(p))).then(p=>Le(p,u))):G.sprites.addLoaded(r,Le(s,u)):typeof s=="string"?G.sprites.add(r,N.from(s,u)):G.sprites.addLoaded(r,N.fromImage(s,u))}i(Ee,"loadSprite");function je(r,s){return s=$(s),G.sprites.add(r,new Promise(async u=>{let p=typeof s=="string"?await Nt(s):s,d=await Promise.all(p.frames.map(_t)),v=document.createElement("canvas");v.width=p.width,v.height=p.height*p.frames.length;let y=v.getContext("2d");d.forEach((V,b)=>{y.drawImage(V,0,b*p.height)});let P=await Ee(null,v,{sliceY:p.frames.length,anims:p.anims});u(P)}))}i(je,"loadPedit");function Ne(r,s,u){s=$(s),u=$(u),typeof s=="string"&&!u&&(u=eo(s)+".json");let p=typeof u=="string"?Nt(u):Promise.resolve(u);return G.sprites.add(r,p.then(d=>{let v=d.meta.size,y=d.frames.map(V=>new ue(V.frame.x/v.w,V.frame.y/v.h,V.frame.w/v.w,V.frame.h/v.h)),P={};for(let V of d.meta.frameTags)V.from===V.to?P[V.name]=V.from:P[V.name]={from:V.from,to:V.to,speed:10,loop:!0,pingpong:V.direction==="pingpong"};return N.from(s,{frames:y,anims:P})}))}i(Ne,"loadAseprite");function _e(r,s,u){return G.shaders.addLoaded(r,Pt(s,u))}i(_e,"loadShader");function ft(r,s,u){s=$(s),u=$(u);let p=i(v=>v?io(v):Promise.resolve(null),"resolveUrl"),d=Promise.all([p(s),p(u)]).then(([v,y])=>Pt(v,y));return G.shaders.add(r,d)}i(ft,"loadShaderURL");function Se(r,s){return s=$(s),G.sounds.add(r,typeof s=="string"?z.fromURL(s):z.fromArrayBuffer(s))}i(Se,"loadSound");function Ve(r,s){let u=new Audio(s);return u.preload="auto",G.music[r]=$(s)}i(Ve,"loadMusic");function ze(r="bean"){return Ee(r,Xo)}i(ze,"loadBean");function rt(r){return G.sprites.get(r)}i(rt,"getSprite");function ot(r){return G.sounds.get(r)}i(ot,"getSound");function wt(r){return G.fonts.get(r)}i(wt,"getFont");function Yt(r){return G.bitmapFonts.get(r)}i(Yt,"getBitmapFont");function Xt(r){return G.shaders.get(r)}i(Xt,"getShader");function Sn(r){return G.custom.get(r)}i(Sn,"getAsset");function $t(r){if(typeof r=="string"){let s=rt(r);if(s)return s;if(k()<1)return null;throw new Error(`Sprite not found: ${r}`)}else{if(r instanceof N)return Re.loaded(r);if(r instanceof Re)return r;throw new Error(`Invalid sprite: ${r}`)}}i($t,"resolveSprite");function An(r){if(typeof r=="string"){let s=ot(r);if(s)return s;if(k()<1)return null;throw new Error(`Sound not found: ${r}`)}else{if(r instanceof z)return Re.loaded(r);if(r instanceof Re)return r;throw new Error(`Invalid sound: ${r}`)}}i(An,"resolveSound");function On(r){if(!r)return w.defShader;if(typeof r=="string"){let s=Xt(r);if(s)return s.data??s;if(k()<1)return null;throw new Error(`Shader not found: ${r}`)}else if(r instanceof Re)return r.data?r.data:r;return r}i(On,"resolveShader");function Wt(r){if(!r)return Wt(t.font??ao);if(typeof r=="string"){let s=Yt(r),u=wt(r);if(s)return s.data??s;if(u)return u.data??u;if(document.fonts.check(`${64}px ${r}`))return r;if(k()<1)return null;throw new Error(`Font not found: ${r}`)}else if(r instanceof Re)return r.data?r.data:r;return r}i(Wt,"resolveFont");function Rn(r){return r!==void 0&&(K.masterNode.gain.value=r),K.masterNode.gain.value}i(Rn,"volume");function Un(r,s={}){let u=new ye,p=new Audio(r);K.ctx.createMediaElementSource(p).connect(K.masterNode);function v(){ce.paused||m.isHidden()&&!t.backgroundAudio||K.ctx.resume()}i(v,"resumeAudioCtx");function y(){v(),p.play()}return i(y,"play"),s.paused||y(),p.onended=()=>u.trigger(),{play(){y()},seek(P){p.currentTime=P},stop(){p.pause(),this.seek(0)},set loop(P){p.loop=P},get loop(){return p.loop},set paused(P){P?p.pause():y()},get paused(){return p.paused},time(){return p.currentTime},duration(){return p.duration},set volume(P){p.volume=Qe(P,0,1)},get volume(){return p.volume},set speed(P){p.playbackRate=Math.max(P,0)},get speed(){return p.playbackRate},set detune(P){},get detune(){return 0},onEnd(P){return u.add(P)},then(P){return this.onEnd(P)}}}i(Un,"playMusic");function Qt(r,s={}){if(typeof r=="string"&&G.music[r])return Un(G.music[r],s);let u=K.ctx,p=s.paused??!1,d=u.createBufferSource(),v=new ye,y=u.createGain(),P=s.seek??0,V=0,b=0,R=!1;d.loop=!!s.loop,d.detune.value=s.detune??0,d.playbackRate.value=s.speed??1,d.connect(y),d.onended=()=>{Y()>=(d.buffer?.duration??Number.POSITIVE_INFINITY)&&v.trigger()},y.connect(K.masterNode),y.gain.value=s.volume??1;let L=i(j=>{d.buffer=j.buf,p||(V=u.currentTime,d.start(0,P),R=!0)},"start"),B=An(r);B instanceof Re&&B.onLoad(L);let Y=i(()=>{if(!d.buffer)return 0;let j=p?b-V:u.currentTime-V,F=d.buffer.duration;return d.loop?j%F:Math.min(j,F)},"getTime"),X=i(j=>{let F=u.createBufferSource();return F.buffer=j.buffer,F.loop=j.loop,F.playbackRate.value=j.playbackRate.value,F.detune.value=j.detune.value,F.onended=j.onended,F.connect(y),F},"cloneNode");return{stop(){this.paused=!0,this.seek(0)},set paused(j){if(p!==j)if(p=j,j)R&&(d.stop(),R=!1),b=u.currentTime;else{d=X(d);let F=b-V;d.start(0,F),R=!0,V=u.currentTime-F,b=0}},get paused(){return p},play(j=0){this.seek(j),this.paused=!1},seek(j){d.buffer?.duration&&(j>d.buffer.duration||(p?(d=X(d),V=b-j):(d.stop(),d=X(d),V=u.currentTime-j,d.start(0,j),R=!0,b=0)))},set speed(j){d.playbackRate.value=j},get speed(){return d.playbackRate.value},set detune(j){d.detune.value=j},get detune(){return d.detune.value},set volume(j){y.gain.value=Math.max(j,0)},get volume(){return y.gain.value},set loop(j){d.loop=j},get loop(){return d.loop},duration(){return d.buffer?.duration??0},time(){return Y()%this.duration()},onEnd(j){return v.add(j)},then(j){return this.onEnd(j)}}}i(Qt,"play");function Jt(r){return Qt(K.burpSnd,r)}i(Jt,"burp");function Vn(r,s){let u=new yt(U,r,s);return{clear:()=>u.clear(),free:()=>u.free(),toDataURL:()=>u.toDataURL(),toImageData:()=>u.toImageData(),width:u.width,height:u.height,draw:p=>{Pe(),u.bind(),p(),Pe(),u.unbind()}}}i(Vn,"makeCanvas");function Pt(r=gn,s=bn){let u=mo.replace("{{user}}",r??gn),p=ho.replace("{{user}}",s??bn);try{return new dn(U,u,p,fn.map(d=>d.name))}catch(d){let y=/(?<type>^\w+) SHADER ERROR: 0:(?<line>\d+): (?<msg>.+)/,P=no(d).match(y),V=Number(P.groups.line)-14,b=P.groups.msg.trim(),R=P.groups.type.toLowerCase();throw new Error(`${R} shader line ${V}: ${b}`)}}i(Pt,"makeShader");function Pn(r,s,u,p){let d=r.width/s,v={},y=p.split("").entries();for(let[P,V]of y)v[V]=new ue(P%d*s,Math.floor(P/d)*u,s,u);return{tex:r,map:v,size:u}}i(Pn,"makeFont");function Dt(r,s,u,p=w.defTex,d=w.defShader,v={}){let y=On(d);if(!y||y instanceof Re)return;let P=w.fixed||u?w.transform:A.cam.transform.mult(w.transform),V=[];for(let b of r){let R=Zt(P.multVec2(b.pos));V.push(R.x,R.y,b.uv.x,b.uv.y,b.color.r/255,b.color.g/255,b.color.b/255,b.opacity)}w.renderer.push(g.TRIANGLES,V,s,y,p,v)}i(Dt,"drawRaw");function Pe(){w.renderer.flush()}i(Pe,"flush");function Ct(){g.clear(g.COLOR_BUFFER_BIT),w.frameBuffer.bind(),g.clear(g.COLOR_BUFFER_BIT),w.bgColor||ut(()=>{it({width:De(),height:ke(),quad:new ue(0,0,De()/64,ke()/64),tex:w.bgTex,fixed:!0})}),w.renderer.numDraws=0,w.fixed=!1,w.transformStack.length=0,w.transform=new Me}i(Ct,"frameStart");function Dn(r,s){w.postShader=r,w.postShaderUniform=s??null}i(Dn,"usePostEffect");function Mt(){Pe(),w.lastDrawCalls=w.renderer.numDraws,w.frameBuffer.unbind(),g.viewport(0,0,g.drawingBufferWidth,g.drawingBufferHeight);let r=w.width,s=w.height;w.width=g.drawingBufferWidth/c,w.height=g.drawingBufferHeight/c,Gt({flipY:!0,tex:w.frameBuffer.tex,pos:new C(w.viewport.x,w.viewport.y),width:w.viewport.width,height:w.viewport.height,shader:w.postShader,uniform:typeof w.postShaderUniform=="function"?w.postShaderUniform():w.postShaderUniform,fixed:!0}),Pe(),w.width=r,w.height=s}i(Mt,"frameEnd");function Zt(r){return new C(r.x/De()*2-1,-r.y/ke()*2+1)}i(Zt,"screen2ndc");function Mn(r){w.transform=r.clone()}i(Mn,"pushMatrix");function le(...r){if(r[0]===void 0)return;let s=E(...r);s.x===0&&s.y===0||w.transform.translate(s)}i(le,"pushTranslate");function de(...r){if(r[0]===void 0)return;let s=E(...r);s.x===1&&s.y===1||w.transform.scale(s)}i(de,"pushScale");function He(r){r&&w.transform.rotate(r)}i(He,"pushRotate");function be(){w.transformStack.push(w.transform.clone())}i(be,"pushTransform");function Ae(){w.transformStack.length>0&&(w.transform=w.transformStack.pop())}i(Ae,"popTransform");function it(r){if(r.width===void 0||r.height===void 0)throw new Error('drawUVQuad() requires property "width" and "height".');if(r.width<=0||r.height<=0)return;let s=r.width,u=r.height,d=pt(r.anchor||Ut).scale(new C(s,u).scale(-.5)),v=r.quad||new ue(0,0,1,1),y=r.color||te(255,255,255),P=r.opacity??1,V=r.tex?.1/r.tex.width:0,b=r.tex?.1/r.tex.height:0,R=v.x+V,L=v.y+b,B=v.w-V*2,Y=v.h-b*2;be(),le(r.pos),He(r.angle),de(r.scale),le(d),Dt([{pos:new C(-s/2,u/2),uv:new C(r.flipX?R+B:R,r.flipY?L:L+Y),color:y,opacity:P},{pos:new C(-s/2,-u/2),uv:new C(r.flipX?R+B:R,r.flipY?L+Y:L),color:y,opacity:P},{pos:new C(s/2,-u/2),uv:new C(r.flipX?R:R+B,r.flipY?L+Y:L),color:y,opacity:P},{pos:new C(s/2,u/2),uv:new C(r.flipX?R:R+B,r.flipY?L:L+Y),color:y,opacity:P}],[0,1,3,1,2,3],r.fixed,r.tex,r.shader,r.uniform),Ae()}i(it,"drawUVQuad");function Gt(r){if(!r.tex)throw new Error('drawTexture() requires property "tex".');let s=r.quad??new ue(0,0,1,1),u=r.tex.width*s.w,p=r.tex.height*s.h,d=new C(1);if(r.tiled){let v=Math.ceil((r.width||u)/u),y=Math.ceil((r.height||p)/p),V=pt(r.anchor||Ut).add(new C(1,1)).scale(.5).scale(v*u,y*p);for(let b=0;b<v;b++)for(let R=0;R<y;R++)it(Object.assign({},r,{pos:(r.pos||new C(0)).add(new C(u*b,p*R)).sub(V),scale:d.scale(r.scale||new C(1)),tex:r.tex,quad:s,width:u,height:p,anchor:"topleft"}))}else r.width&&r.height?(d.x=r.width/u,d.y=r.height/p):r.width?(d.x=r.width/u,d.y=d.x):r.height&&(d.y=r.height/p,d.x=d.y),it(Object.assign({},r,{scale:d.scale(r.scale||new C(1)),tex:r.tex,quad:s,width:u,height:p}))}i(Gt,"drawTexture");function en(r){if(!r.sprite)throw new Error('drawSprite() requires property "sprite"');let s=$t(r.sprite);if(!s||!s.data)return;let u=s.data.frames[r.frame??0];if(!u)throw new Error(`Frame not found: ${r.frame??0}`);Gt(Object.assign({},r,{tex:s.data.tex,quad:u.scale(r.quad??new ue(0,0,1,1))}))}i(en,"drawSprite");function st(r,s,u,p,d,v=1){p=xe(p%360),d=xe(d%360),d<=p&&(d+=Math.PI*2);let y=[],P=Math.ceil((d-p)/xe(8)*v),V=(d-p)/P;for(let b=p;b<d;b+=V)y.push(r.add(s*Math.cos(b),u*Math.sin(b)));return y.push(r.add(s*Math.cos(d),u*Math.sin(d))),y}i(st,"getArcPts");function h(r){if(r.width===void 0||r.height===void 0)throw new Error('drawRect() requires property "width" and "height".');if(r.width<=0||r.height<=0)return;let s=r.width,u=r.height,d=pt(r.anchor||Ut).add(1,1).scale(new C(s,u).scale(-.5)),v=[new C(0,0),new C(s,0),new C(s,u),new C(0,u)];if(r.radius){let y=Math.min(Math.min(s,u)/2,r.radius);v=[new C(y,0),new C(s-y,0),...st(new C(s-y,y),y,y,270,360),new C(s,y),new C(s,u-y),...st(new C(s-y,u-y),y,y,0,90),new C(s-y,u),new C(y,u),...st(new C(y,u-y),y,y,90,180),new C(0,u-y),new C(0,y),...st(new C(y,y),y,y,180,270)]}ct(Object.assign({},r,{offset:d,pts:v,...r.gradient?{colors:r.horizontal?[r.gradient[0],r.gradient[1],r.gradient[1],r.gradient[0]]:[r.gradient[0],r.gradient[0],r.gradient[1],r.gradient[1]]}:{}}))}i(h,"drawRect");function T(r){let{p1:s,p2:u}=r;if(!s||!u)throw new Error('drawLine() requires properties "p1" and "p2".');let p=r.width||1,d=u.sub(s).unit().normal().scale(p*.5),v=[s.sub(d),s.add(d),u.add(d),u.sub(d)].map(y=>({pos:new C(y.x,y.y),uv:new C(0),color:r.color??Z.WHITE,opacity:r.opacity??1}));Dt(v,[0,1,3,1,2,3],r.fixed,w.defTex,r.shader,r.uniform)}i(T,"drawLine");function D(r){let s=r.pts;if(!s)throw new Error('drawLines() requires property "pts".');if(!(s.length<2))if(r.radius&&s.length>=3){let u=s[0].sdist(s[1]);for(let d=1;d<s.length-1;d++)u=Math.min(s[d].sdist(s[d+1]),u);let p=Math.min(r.radius,Math.sqrt(u)/2);T(Object.assign({},r,{p1:s[0],p2:s[1]}));for(let d=1;d<s.length-2;d++){let v=s[d],y=s[d+1];T(Object.assign({},r,{p1:v,p2:y}))}T(Object.assign({},r,{p1:s[s.length-2],p2:s[s.length-1]}))}else for(let u=0;u<s.length-1;u++)T(Object.assign({},r,{p1:s[u],p2:s[u+1]})),r.join!=="none"&&Ke(Object.assign({},r,{pos:s[u],radius:r.width/2}))}i(D,"drawLines");function H(r,s){let u=s.segments??16,p=[];for(let d=0;d<=u;d++)p.push(r(d/u));D({pts:p,width:s.width||1,pos:s.pos,color:s.color})}i(H,"drawCurve");function ve(r){H(s=>tr(r.pt1,r.pt2,r.pt3,r.pt4,s),r)}i(ve,"drawBezier");function re(r){if(!r.p1||!r.p2||!r.p3)throw new Error('drawTriangle() requires properties "p1", "p2" and "p3".');return ct(Object.assign({},r,{pts:[r.p1,r.p2,r.p3]}))}i(re,"drawTriangle");function Ke(r){if(typeof r.radius!="number")throw new Error('drawCircle() requires property "radius".');r.radius!==0&&at(Object.assign({},r,{radiusX:r.radius,radiusY:r.radius,angle:0}))}i(Ke,"drawCircle");function at(r){if(r.radiusX===void 0||r.radiusY===void 0)throw new Error('drawEllipse() requires properties "radiusX" and "radiusY".');if(r.radiusX===0||r.radiusY===0)return;let s=r.start??0,u=r.end??360,p=pt(r.anchor??"center").scale(new C(-r.radiusX,-r.radiusY)),d=st(p,r.radiusX,r.radiusY,s,u,r.resolution);d.unshift(p);let v=Object.assign({},r,{pts:d,radius:0,...r.gradient?{colors:[r.gradient[0],...Array(d.length-1).fill(r.gradient[1])]}:{}});if(u-s>=360&&r.outline){r.fill!==!1&&ct(Object.assign({},v,{outline:null})),ct(Object.assign({},v,{pts:d.slice(1),fill:!1}));return}ct(v)}i(at,"drawEllipse");function ct(r){if(!r.pts)throw new Error('drawPolygon() requires property "pts".');let s=r.pts.length;if(!(s<3)){if(be(),le(r.pos),de(r.scale),He(r.angle),le(r.offset),r.fill!==!1){let u=r.color??Z.WHITE,p=r.pts.map((v,y)=>({pos:new C(v.x,v.y),uv:r.uv?r.uv[y]:new C(0,0),color:r.colors&&r.colors[y]?r.colors[y].mult(u):u,opacity:r.opacity??1})),d;r.triangulate&&rr(r.pts)?d=nr(r.pts).map(y=>y.map(P=>r.pts.indexOf(P))).flat():d=[...Array(s-2).keys()].map(v=>[0,v+1,v+2]).flat(),Dt(p,r.indices??d,r.fixed,r.uv?r.tex:w.defTex,r.shader,r.uniform)}r.outline&&D({pts:[...r.pts,r.pts[0]],radius:r.radius,width:r.outline.width,color:r.outline.color,join:r.outline.join,uniform:r.uniform,fixed:r.fixed,opacity:r.opacity}),Ae()}}i(ct,"drawPolygon");function $e(r,s,u){Pe(),g.clear(g.STENCIL_BUFFER_BIT),g.enable(g.STENCIL_TEST),g.stencilFunc(g.NEVER,1,255),g.stencilOp(g.REPLACE,g.REPLACE,g.REPLACE),s(),Pe(),g.stencilFunc(u,1,255),g.stencilOp(g.KEEP,g.KEEP,g.KEEP),r(),Pe(),g.disable(g.STENCIL_TEST)}i($e,"drawStenciled");function Et(r,s){$e(r,s,g.EQUAL)}i(Et,"drawMasked");function br(r,s){$e(r,s,g.NOTEQUAL)}i(br,"drawSubtracted");function ii(){return(w.viewport.width+w.viewport.height)/(w.width+w.height)}i(ii,"getViewportScale");function ut(r){Pe();let s=w.width,u=w.height;w.width=w.viewport.width,w.height=w.viewport.height,r(),Pe(),w.width=s,w.height=u}i(ut,"drawUnscaled");function vr(r,s){s.pos&&(r.pos=r.pos.add(s.pos)),s.scale&&(r.scale=r.scale.scale(E(s.scale))),s.angle&&(r.angle+=s.angle),s.color&&r.ch.length===1&&(r.color=r.color.mult(s.color)),s.opacity&&(r.opacity*=s.opacity)}i(vr,"applyCharTransform");function si(r){let s={},u=r.replace(pr,"$2"),p=0;for(let d of r.matchAll(pr)){let v=d.index-p;for(let y=0;y<d.groups.text.length;y++)s[y+v]=[d.groups.style];p+=d[0].length-d.groups.text.length}return{charStyleMap:s,text:u}}i(si,"compileStyledText");let Gn={};function Tt(r){if(r.text===void 0)throw new Error('formatText() requires property "text".');let s=Wt(r.font);if(r.text===""||s instanceof Re||!s)return{width:0,height:0,chars:[],opt:r};let{charStyleMap:u,text:p}=si(r.text+""),d=ro(p);if(s instanceof ie||typeof s=="string"){let me=s instanceof ie?s.fontface.family:s,se=s instanceof ie?{outline:s.outline,filter:s.filter}:{outline:null,filter:pn},q=Gn[me]??{font:{tex:new qe(U,2048,2048,{filter:se.filter}),map:{},size:64},cursor:new C(0),outline:se.outline};Gn[me]||(Gn[me]=q),s=q.font;for(let We of d)if(!q.font.map[We]){let S=x;S.clearRect(0,0,f.width,f.height),S.font=`${s.size}px ${me}`,S.textBaseline="top",S.textAlign="left",S.fillStyle="#ffffff";let I=S.measureText(We),M=Math.ceil(I.width);if(!M)continue;let _=s.size;q.outline&&(S.lineJoin="round",S.lineWidth=q.outline.width*2,S.strokeStyle=q.outline.color.toHex(),S.strokeText(We,q.outline.width,q.outline.width),M+=q.outline.width*2,_+=q.outline.width*3),S.fillText(We,q.outline?.width??0,q.outline?.width??0);let Q=S.getImageData(0,0,M,_);if(q.cursor.x+M>2048&&(q.cursor.x=0,q.cursor.y+=_,q.cursor.y>2048))throw new Error("Font atlas exceeds character limit");s.tex.update(Q,q.cursor.x,q.cursor.y),s.map[We]=new ue(q.cursor.x,q.cursor.y,M,_),q.cursor.x+=M}}let v=r.size||s.size,y=E(r.scale??1).scale(v/s.size),P=r.lineSpacing??0,V=r.letterSpacing??0,b=0,R=0,L=0,B=[],Y=[],X=0,j=null,F=null;for(;X<d.length;){let me=d[X];if(me===`
`)L+=v+P,B.push({width:b-V,chars:Y}),j=null,F=null,b=0,Y=[];else{let se=s.map[me];if(se){let q=se.w*y.x;r.width&&b+q>r.width&&(L+=v+P,j!=null&&(X-=Y.length-j,me=d[X],se=s.map[me],q=se.w*y.x,Y=Y.slice(0,j-1),b=F),j=null,F=null,B.push({width:b-V,chars:Y}),b=0,Y=[]),Y.push({tex:s.tex,width:se.w,height:se.h,quad:new ue(se.x/s.tex.width,se.y/s.tex.height,se.w/s.tex.width,se.h/s.tex.height),ch:me,pos:new C(b,L),opacity:r.opacity??1,color:r.color??Z.WHITE,scale:E(y),angle:0}),me===" "&&(j=Y.length,F=b),b+=q,R=Math.max(R,b),b+=V}}X++}B.push({width:b-V,chars:Y}),L+=v,r.width&&(R=r.width);let Te=[];for(let me=0;me<B.length;me++){let se=(R-B[me].width)*ea(r.align??"left");for(let q of B[me].chars){let We=s.map[q.ch],S=Te.length+me;if(q.pos=q.pos.add(se,0).add(We.w*y.x*.5,We.h*y.y*.5),r.transform){let I=typeof r.transform=="function"?r.transform(S,q.ch):r.transform;I&&vr(q,I)}if(u[S]){let I=u[S];for(let M of I){let _=r.styles[M],Q=typeof _=="function"?_(S,q.ch):_;Q&&vr(q,Q)}}Te.push(q)}}return{width:R,height:L,chars:Te,opt:r}}i(Tt,"formatText");function xr(r){St(Tt(r))}i(xr,"drawText");function St(r){be(),le(r.opt.pos),He(r.opt.angle),le(pt(r.opt.anchor??"topleft").add(1,1).scale(r.width,r.height).scale(-.5)),r.chars.forEach(s=>{it({tex:s.tex,width:s.width,height:s.height,pos:s.pos,scale:s.scale,angle:s.angle,color:s.color,opacity:s.opacity,quad:s.quad,anchor:"center",uniform:r.opt.uniform,shader:r.opt.shader,fixed:r.opt.fixed})}),Ae()}i(St,"drawFormattedText");function De(){return w.width}i(De,"width");function ke(){return w.height}i(ke,"height");function ai(r){return new C((r.x-w.viewport.x)*De()/w.viewport.width,(r.y-w.viewport.y)*ke()/w.viewport.height)}i(ai,"windowToContent");function ci(r){return new C(r.x*w.viewport.width/w.width,r.y*w.viewport.height/w.height)}i(ci,"contentToView");function yr(){return ai(m.mousePos())}i(yr,"mousePos");let wr=!1,ce={inspect:!1,timeScale:1,showLog:!0,fps:()=>m.fps(),numFrames:()=>m.numFrames(),stepFrame:Rr,drawCalls:()=>w.lastDrawCalls,clearLog:()=>A.logs=[],log:r=>{let s=t.logMax??8;A.logs.unshift({msg:r,time:m.time()}),A.logs.length>s&&(A.logs=A.logs.slice(0,s))},error:r=>ce.log(new Error(r.toString?r.toString():r)),curRecording:null,numObjects:()=>kn("*",{recursive:!0}).length,get paused(){return wr},set paused(r){wr=r,r?K.ctx.suspend():K.ctx.resume()}};function Bn(){return m.dt()*ce.timeScale}i(Bn,"dt");function ui(...r){return r.length>0&&(A.cam.pos=E(...r)),A.cam.pos?A.cam.pos.clone():nn()}i(ui,"camPos");function li(...r){return r.length>0&&(A.cam.scale=E(...r)),A.cam.scale.clone()}i(li,"camScale");function mi(r){return r!==void 0&&(A.cam.angle=r),A.cam.angle}i(mi,"camRot");function di(r=12){A.cam.shake+=r}i(di,"shake");function hi(r){return A.cam.transform.multVec2(r)}i(hi,"toScreen");function pi(r){return A.cam.transform.invert().multVec2(r)}i(pi,"toWorld");function Cr(r){let s=new Me;return r.pos&&s.translate(r.pos),r.scale&&s.scale(r.scale),r.angle&&s.rotate(r.angle),r.parent?s.mult(r.parent.transform):s}i(Cr,"calcTransform");function Fn(r=[]){let s=new Map,u={},p=new tt,d=[],v=null,y=!1,P={id:to(),hidden:!1,transform:new Me,children:[],parent:null,set paused(b){if(b!==y){y=b;for(let R of d)R.paused=b}},get paused(){return y},add(b=[]){let R=Array.isArray(b)?Fn(b):b;if(R.parent)throw new Error("Cannot add a game obj that already has a parent.");return R.parent=this,R.transform=Cr(R),this.children.push(R),R.trigger("add",R),A.events.trigger("add",R),R},readd(b){let R=this.children.indexOf(b);return R!==-1&&(this.children.splice(R,1),this.children.push(b)),b},remove(b){let R=this.children.indexOf(b);if(R!==-1){b.parent=null,this.children.splice(R,1);let L=i(B=>{B.trigger("destroy"),A.events.trigger("destroy",B),B.children.forEach(Y=>L(Y))},"trigger");L(b)}},removeAll(b){if(b)this.get(b).forEach(R=>this.remove(R));else for(let R of[...this.children])this.remove(R)},update(){this.paused||(this.children.sort((b,R)=>(b.z??0)-(R.z??0)).forEach(b=>b.update()),this.trigger("update"))},draw(){if(this.hidden)return;this.canvas&&(Pe(),this.canvas.bind());let b=w.fixed;this.fixed&&(w.fixed=!0),be(),le(this.pos),de(this.scale),He(this.angle);let R=this.children.sort((L,B)=>(L.z??0)-(B.z??0));if(this.mask){let L={intersect:Et,subtract:br}[this.mask];if(!L)throw new Error(`Invalid mask func: "${this.mask}"`);L(()=>{R.forEach(B=>B.draw())},()=>{this.trigger("draw")})}else this.trigger("draw"),R.forEach(L=>L.draw());Ae(),w.fixed=b,this.canvas&&(Pe(),this.canvas.unbind())},drawInspect(){this.hidden||(be(),le(this.pos),de(this.scale),He(this.angle),this.children.sort((b,R)=>(b.z??0)-(R.z??0)).forEach(b=>b.drawInspect()),this.trigger("drawInspect"),Ae())},use(b){if(!b)return;if(typeof b=="string")return this.use({id:b});let R=[];b.id&&(this.unuse(b.id),u[b.id]=[],R=u[b.id],s.set(b.id,b));for(let B in b){if(po.has(B))continue;let Y=Object.getOwnPropertyDescriptor(b,B);if(typeof Y.value=="function"&&(b[B]=b[B].bind(this)),Y.set&&Object.defineProperty(b,B,{set:Y.set.bind(this)}),Y.get&&Object.defineProperty(b,B,{get:Y.get.bind(this)}),fo.has(B)){let X=B==="add"?()=>{v=i(j=>R.push(j),"onCurCompCleanup"),b[B](),v=null}:b[B];R.push(this.on(B,X).cancel)}else if(this[B]===void 0)Object.defineProperty(this,B,{get:()=>b[B],set:X=>b[B]=X,configurable:!0,enumerable:!0}),R.push(()=>delete this[B]);else throw new Error(`Duplicate component property: "${B}"`)}let L=i(()=>{if(b.require){for(let B of b.require)if(!this.c(B))throw new Error(`Component "${b.id}" requires component "${B}"`)}},"checkDeps");b.destroy&&R.push(b.destroy.bind(this)),this.exists()?(L(),b.add&&(v=i(B=>R.push(B),"onCurCompCleanup"),b.add.call(this),v=null)):b.require&&R.push(this.on("add",L).cancel)},unuse(b){u[b]&&(u[b].forEach(R=>R()),delete u[b]),s.has(b)&&s.delete(b)},c(b){return s.get(b)},get(b,R={}){let L=R.recursive?this.children.flatMap(i(function B(Y){return[Y,...Y.children.flatMap(B)]},"recurse")):this.children;if(L=L.filter(B=>b?B.is(b):!0),R.liveUpdate){let B=i(X=>R.recursive?this.isAncestorOf(X):X.parent===this,"isChild"),Y=[];Y.push(In(X=>{B(X)&&X.is(b)&&L.push(X)})),Y.push(Er(X=>{if(B(X)&&X.is(b)){let j=L.findIndex(F=>F.id===X.id);j!==-1&&L.splice(j,1)}})),this.onDestroy(()=>{for(let X of Y)X.cancel()})}return L},isAncestorOf(b){return b.parent?b.parent===this||this.isAncestorOf(b.parent):!1},exists(){return A.root.isAncestorOf(this)},is(b){if(b==="*")return!0;if(Array.isArray(b)){for(let R of b)if(!this.c(R))return!1;return!0}else return this.c(b)!=null},on(b,R){let L=p.on(b,R.bind(this));return v&&v(()=>L.cancel()),L},trigger(b,...R){p.trigger(b,...R),A.objEvents.trigger(b,this,...R)},destroy(){this.parent&&this.parent.remove(this)},inspect(){let b={};for(let[R,L]of s)b[R]=L.inspect?L.inspect():null;return b},onAdd(b){return this.on("add",b)},onUpdate(b){return this.on("update",b)},onDraw(b){return this.on("draw",b)},onDestroy(b){return this.on("destroy",b)},clearEvents(){p.clear()}},V=["onKeyPress","onKeyPressRepeat","onKeyDown","onKeyRelease","onMousePress","onMouseDown","onMouseRelease","onMouseMove","onCharInput","onMouseMove","onTouchStart","onTouchMove","onTouchEnd","onScroll","onGamepadButtonPress","onGamepadButtonDown","onGamepadButtonRelease","onGamepadStick"];for(let b of V)P[b]=(...R)=>{let L=m[b](...R);return d.push(L),P.onDestroy(()=>L.cancel()),L};for(let b of r)P.use(b);return P}i(Fn,"make");function lt(r,s,u){return A.objEvents[r]||(A.objEvents[r]=new jt),A.objEvents.on(r,(p,...d)=>{p.is(s)&&u(p,...d)})}i(lt,"on");let fi=Fe(r=>{let s=Bt([{update:r}]);return{get paused(){return s.paused},set paused(u){s.paused=u},cancel:()=>s.destroy()}},(r,s)=>lt("update",r,s)),gi=Fe(r=>{let s=Bt([{draw:r}]);return{get paused(){return s.hidden},set paused(u){s.hidden=u},cancel:()=>s.destroy()}},(r,s)=>lt("draw",r,s)),In=Fe(r=>A.events.on("add",r),(r,s)=>lt("add",r,s)),Er=Fe(r=>A.events.on("destroy",r),(r,s)=>lt("destroy",r,s));function bi(r,s,u){return lt("collide",r,(p,d,v)=>d.is(s)&&u(p,d,v))}i(bi,"onCollide");function vi(r,s,u){return lt("collideUpdate",r,(p,d,v)=>d.is(s)&&u(p,d,v))}i(vi,"onCollideUpdate");function xi(r,s,u){return lt("collideEnd",r,(p,d,v)=>d.is(s)&&u(p,d,v))}i(xi,"onCollideEnd");function tn(r,s){kn(r,{recursive:!0}).forEach(s),In(r,s)}i(tn,"forAllCurrentAndFuture");let yi=Fe(r=>m.onMousePress(r),(r,s)=>{let u=[];return tn(r,p=>{if(!p.area)throw new Error("onClick() requires the object to have area() component");u.push(p.onClick(()=>s(p)))}),et.join(u)});function wi(r,s){let u=[];return tn(r,p=>{if(!p.area)throw new Error("onHover() requires the object to have area() component");u.push(p.onHover(()=>s(p)))}),et.join(u)}i(wi,"onHover");function Ci(r,s){let u=[];return tn(r,p=>{if(!p.area)throw new Error("onHoverUpdate() requires the object to have area() component");u.push(p.onHoverUpdate(()=>s(p)))}),et.join(u)}i(Ci,"onHoverUpdate");function Ei(r,s){let u=[];return tn(r,p=>{if(!p.area)throw new Error("onHoverEnd() requires the object to have area() component");u.push(p.onHoverEnd(()=>s(p)))}),et.join(u)}i(Ei,"onHoverEnd");function Ti(r){A.gravity=A.gravity.unit().scale(r)}i(Ti,"setGravity");function Si(){return A.gravity.len()}i(Si,"getGravity");function Ai(r){A.gravity=r.unit().scale(A.gravity.len())}i(Ai,"setGravityDirection");function Oi(){return A.gravity.unit()}i(Oi,"getGravityDirection");function Ri(...r){r.length===1||r.length===2?(w.bgColor=te(r[0]),r[1]&&(w.bgAlpha=r[1])):(r.length===3||r.length===4)&&(w.bgColor=te(r[0],r[1],r[2]),r[3]&&(w.bgAlpha=r[3])),g.clearColor(w.bgColor.r/255,w.bgColor.g/255,w.bgColor.b/255,w.bgAlpha)}i(Ri,"setBackground");function Ui(){return w.bgColor.clone()}i(Ui,"getBackground");function Vi(...r){return{id:"color",color:te(...r),inspect(){return this.color.toString()}}}i(Vi,"color");function Ln(r,s){return Number(r.toFixed(s))}i(Ln,"toFixed");function Tr(r){return r.fixed?!0:r.parent?Tr(r.parent):!1}i(Tr,"isFixed");function Pi(r){return{color:r.color,opacity:r.opacity,anchor:r.anchor,outline:r.outline,shader:r.shader,uniform:r.uniform}}i(Pi,"getRenderProps");function Di(r){G.loaded?r():A.events.on("load",r)}i(Di,"onLoad");function Mi(r,s){A.scenes[r]=s}i(Mi,"scene");function Gi(r,...s){if(!A.scenes[r])throw new Error(`Scene not found: ${r}`);A.events.onOnce("frameEnd",()=>{A.events.trigger("sceneLeave",r),m.events.clear(),A.events.clear(),A.objEvents.clear(),[...A.root.children].forEach(u=>{(!u.stay||u.scenesToStay&&!u.scenesToStay.includes(r))&&A.root.remove(u)}),A.root.clearEvents(),Pr(),A.cam={pos:null,scale:E(1),angle:0,shake:0,transform:new Me},A.scenes[r](...s)}),A.currentScene=r}i(Gi,"go");function Bi(r){return A.events.on("sceneLeave",r)}i(Bi,"onSceneLeave");function Fi(){return A.currentScene}i(Fi,"getSceneName");function Ii(r,s){try{return JSON.parse(window.localStorage[r])}catch{return s?(Sr(r,s),s):null}}i(Ii,"getData");function Sr(r,s){window.localStorage[r]=JSON.stringify(s)}i(Sr,"setData");function Ar(r,...s){let u=r(Xe),p;typeof u=="function"?p=u(...s)(Xe):p=u;for(let d in p)Xe[d]=p[d],t.global!==!1&&(window[d]=p[d]);return Xe}i(Ar,"plug");function nn(){return E(De()/2,ke()/2)}i(nn,"center");let Li;(F=>(F[F.None=0]="None",F[F.Left=1]="Left",F[F.Top=2]="Top",F[F.LeftTop=3]="LeftTop",F[F.Right=4]="Right",F[F.Horizontal=5]="Horizontal",F[F.RightTop=6]="RightTop",F[F.HorizontalTop=7]="HorizontalTop",F[F.Bottom=8]="Bottom",F[F.LeftBottom=9]="LeftBottom",F[F.Vertical=10]="Vertical",F[F.LeftVertical=11]="LeftVertical",F[F.RightBottom=12]="RightBottom",F[F.HorizontalBottom=13]="HorizontalBottom",F[F.RightVertical=14]="RightVertical",F[F.All=15]="All"))(Li||={});function ki(r,s){if(!s.tileWidth||!s.tileHeight)throw new Error("Must provide tileWidth and tileHeight.");let u=Bt([qt(s.pos??E(0))]),p=r.length,d=0,v=null,y=null,P=null,V=null,b=i(S=>S.x+S.y*d,"tile2Hash"),R=i(S=>E(Math.floor(S%d),Math.floor(S/d)),"hash2Tile"),L=i(()=>{v=[];for(let S of u.children)B(S)},"createSpatialMap"),B=i(S=>{let I=b(S.tilePos);v[I]?v[I].push(S):v[I]=[S]},"insertIntoSpatialMap"),Y=i(S=>{let I=b(S.tilePos);if(v[I]){let M=v[I].indexOf(S);M>=0&&v[I].splice(M,1)}},"removeFromSpatialMap"),X=i(()=>{let S=!1;for(let I of u.children){let M=u.pos2Tile(I.pos);(I.tilePos.x!=M.x||I.tilePos.y!=M.y)&&(S=!0,Y(I),I.tilePos.x=M.x,I.tilePos.y=M.y,B(I))}S&&u.trigger("spatial_map_changed")},"updateSpatialMap"),j=i(()=>{let S=u.getSpatialMap(),I=u.numRows()*u.numColumns();y?y.length=I:y=new Array(I),y.fill(1,0,I);for(let M=0;M<S.length;M++){let _=S[M];if(_){let Q=0;for(let ee of _)if(ee.isObstacle){Q=1/0;break}else Q+=ee.cost;y[M]=Q||1}}},"createCostMap"),F=i(()=>{let S=u.getSpatialMap(),I=u.numRows()*u.numColumns();P?P.length=I:P=new Array(I),P.fill(15,0,I);for(let M=0;M<S.length;M++){let _=S[M];if(_){let Q=_.length,ee=15;for(let ge=0;ge<Q;ge++)ee|=_[ge].edgeMask;P[M]=ee}}},"createEdgeMap"),Te=i(()=>{let S=u.numRows()*u.numColumns(),I=i((_,Q)=>{let ee=[];for(ee.push(_);ee.length>0;){let ge=ee.pop();q(ge).forEach(Ce=>{V[Ce]<0&&(V[Ce]=Q,ee.push(Ce))})}},"traverse");V?V.length=S:V=new Array(S),V.fill(-1,0,S);let M=0;for(let _=0;_<y.length;_++){if(V[_]>=0){M++;continue}I(_,M),M++}},"createConnectivityMap"),me=i((S,I)=>y[I],"getCost"),se=i((S,I)=>{let M=R(S),_=R(I);return M.dist(_)},"getHeuristic"),q=i((S,I)=>{let M=[],_=Math.floor(S%d),Q=_>0&&P[S]&1&&y[S-1]!==1/0,ee=S>=d&&P[S]&2&&y[S-d]!==1/0,ge=_<d-1&&P[S]&4&&y[S+1]!==1/0,Ce=S<d*p-d-1&&P[S]&8&&y[S+d]!==1/0;return I?(Q&&(ee&&M.push(S-d-1),M.push(S-1),Ce&&M.push(S+d-1)),ee&&M.push(S-d),ge&&(ee&&M.push(S-d+1),M.push(S+1),Ce&&M.push(S+d+1)),Ce&&M.push(S+d)):(Q&&M.push(S-1),ee&&M.push(S-d),ge&&M.push(S+1),Ce&&M.push(S+d)),M},"getNeighbours"),We={id:"level",tileWidth(){return s.tileWidth},tileHeight(){return s.tileHeight},spawn(S,...I){let M=E(...I),_=(()=>{if(typeof S=="string"){if(s.tiles[S]){if(typeof s.tiles[S]!="function")throw new Error("Level symbol def must be a function returning a component list");return s.tiles[S](M)}else if(s.wildcardTile)return s.wildcardTile(S,M)}else{if(Array.isArray(S))return S;throw new Error("Expected a symbol or a component list")}})();if(!_)return null;let Q=!1,ee=!1;for(let Ce of _)Ce.id==="tile"&&(ee=!0),Ce.id==="pos"&&(Q=!0);Q||_.push(qt()),ee||_.push(fr());let ge=u.add(_);return Q&&(ge.tilePosOffset=ge.pos.clone()),ge.tilePos=M,v&&(B(ge),this.trigger("spatial_map_changed"),this.trigger("navigation_map_invalid")),ge},numColumns(){return d},numRows(){return p},levelWidth(){return d*this.tileWidth()},levelHeight(){return p*this.tileHeight()},tile2Pos(...S){return E(...S).scale(this.tileWidth(),this.tileHeight())},pos2Tile(...S){let I=E(...S);return E(Math.floor(I.x/this.tileWidth()),Math.floor(I.y/this.tileHeight()))},getSpatialMap(){return v||L(),v},onSpatialMapChanged(S){return this.on("spatial_map_changed",S)},onNavigationMapInvalid(S){return this.on("navigation_map_invalid",S)},getAt(S){v||L();let I=b(S);return v[I]||[]},raycast(S,I){S=S.scale(1/this.tileWidth(),1/this.tileHeight());let M=Xr(S,I,_=>{if(this.getAt(_).some(ee=>ee.isObstacle))return!0},64);return M&&(M.point=M.point.scale(this.tileWidth(),this.tileHeight())),M},update(){v&&X()},invalidateNavigationMap(){y=null,P=null,V=null},onNavigationMapChanged(S){return this.on("navigation_map_changed",S)},getTilePath(S,I,M={}){if(y||j(),P||F(),V||Te(),S.x<0||S.x>=d||S.y<0||S.y>=p||I.x<0||I.x>=d||I.y<0||I.y>=p)return null;let _=b(S),Q=b(I);if(y[Q]===1/0)return null;if(_===Q)return[];if(V[_]!=-1&&V[_]!==V[Q])return null;let ee=new un((Ze,_n)=>Ze.cost<_n.cost);ee.insert({cost:0,node:_});let ge=new Map;ge.set(_,_);let Ce=new Map;for(Ce.set(_,0);ee.length!==0;){let Ze=ee.remove()?.node;if(Ze===Q)break;let _n=q(Ze,M.allowDiagonals);for(let gt of _n){let Hn=(Ce.get(Ze)||0)+me(Ze,gt)+se(gt,Q);(!Ce.has(gt)||Hn<Ce.get(gt))&&(Ce.set(gt,Hn),ee.insert({cost:Hn,node:gt}),ge.set(gt,Ze))}}let Nn=[],Ft=Q,as=R(Ft);for(Nn.push(as);Ft!==_;){Ft=ge.get(Ft);let Ze=R(Ft);Nn.push(Ze)}return Nn.reverse()},getPath(S,I,M={}){let _=this.tileWidth(),Q=this.tileHeight(),ee=this.getTilePath(this.pos2Tile(S),this.pos2Tile(I),M);return ee?[S,...ee.slice(1,-1).map(ge=>ge.scale(_,Q).add(_/2,Q/2)),I]:null}};return u.use(We),u.onNavigationMapInvalid(()=>{u.invalidateNavigationMap(),u.trigger("navigation_map_changed")}),r.forEach((S,I)=>{let M=S.split("");d=Math.max(M.length,d),M.forEach((_,Q)=>{u.spawn(_,E(Q,I))})}),u}i(ki,"addLevel");function ji(r){let s=m.canvas.captureStream(r),u=K.ctx.createMediaStreamDestination();K.masterNode.connect(u);let p=new MediaRecorder(s),d=[];return p.ondataavailable=v=>{v.data.size>0&&d.push(v.data)},p.onerror=()=>{K.masterNode.disconnect(u),s.getTracks().forEach(v=>v.stop())},p.start(),{resume(){p.resume()},pause(){p.pause()},stop(){return p.stop(),K.masterNode.disconnect(u),s.getTracks().forEach(v=>v.stop()),new Promise(v=>{p.onstop=()=>{v(new Blob(d,{type:"video/mp4"}))}})},download(v="kaboom.mp4"){this.stop().then(y=>ir(v,y))}}}i(ji,"record");function Ni(){return document.activeElement===m.canvas}i(Ni,"isFocused");function _i(r){r.destroy()}i(_i,"destroy");let Bt=A.root.add.bind(A.root),Hi=A.root.readd.bind(A.root),Ki=A.root.removeAll.bind(A.root),kn=A.root.get.bind(A.root),qi=A.root.wait.bind(A.root),zi=A.root.loop.bind(A.root),Yi=A.root.tween.bind(A.root);function Or(r=2,s=1){let u=0;return{require:["scale"],update(){let p=Math.sin(u*r)*s;p<0&&this.destroy(),this.scale=E(p),u+=Bn()}}}i(Or,"boom");let Xi=Ee(null,Qo),$i=Ee(null,$o);function Wi(r,s={}){let u=Bt([qt(r),gr()]),p=(s.speed||1)*5,d=s.scale||1;u.add([yn($i),zt(0),Cn("center"),Or(p,d),...s.comps??[]]);let v=u.add([yn(Xi),zt(0),Cn("center"),wn(),...s.comps??[]]);return v.wait(.4/p,()=>v.use(Or(p,d))),v.onDestroy(()=>u.destroy()),u}i(Wi,"addKaboom");function Rr(){A.root.update()}i(Rr,"updateFrame");class jn{static{i(this,"Collision")}source;target;displacement;resolved=!1;constructor(s,u,p,d=!1){this.source=s,this.target=u,this.displacement=p,this.resolved=d}reverse(){return new jn(this.target,this.source,this.displacement.scale(-1),this.resolved)}hasOverlap(){return!this.displacement.isZero()}isLeft(){return this.displacement.cross(A.gravity)>0}isRight(){return this.displacement.cross(A.gravity)<0}isTop(){return this.displacement.dot(A.gravity)>0}isBottom(){return this.displacement.dot(A.gravity)<0}preventResolution(){this.resolved=!0}}function Qi(){let r={},s=t.hashGridSize||64,u=new Me,p=[];function d(v){if(p.push(u.clone()),v.pos&&u.translate(v.pos),v.scale&&u.scale(v.scale),v.angle&&u.rotate(v.angle),v.transform=u.clone(),v.c("area")&&!v.paused){let y=v,V=y.worldArea().bbox(),b=Math.floor(V.pos.x/s),R=Math.floor(V.pos.y/s),L=Math.ceil((V.pos.x+V.width)/s),B=Math.ceil((V.pos.y+V.height)/s),Y=new Set;for(let X=b;X<=L;X++)for(let j=R;j<=B;j++)if(!r[X])r[X]={},r[X][j]=[y];else if(!r[X][j])r[X][j]=[y];else{let F=r[X][j];e:for(let Te of F){if(Te.paused||!Te.exists()||Y.has(Te.id))continue;for(let se of y.collisionIgnore)if(Te.is(se))continue e;for(let se of Te.collisionIgnore)if(y.is(se))continue e;let me=$r(y.worldArea(),Te.worldArea());if(me){let se=new jn(y,Te,me);y.trigger("collideUpdate",Te,se);let q=se.reverse();q.resolved=se.resolved,Te.trigger("collideUpdate",y,q)}Y.add(Te.id)}F.push(y)}}v.children.forEach(d),u=p.pop()}i(d,"checkObj"),d(A.root)}i(Qi,"checkFrame");function Ji(){let r=A.cam,s=C.fromAngle(Lt(0,360)).scale(r.shake);r.shake=Je(r.shake,0,5*Bn()),r.transform=new Me().translate(nn()).scale(r.scale).rotate(r.angle).translate((r.pos??nn()).scale(-1).add(s)),A.root.draw(),Pe()}i(Ji,"drawFrame");function Zi(){let r=k();A.events.numListeners("loading")>0?A.events.trigger("loading",r):ut(()=>{let s=De()/2,u=24,p=E(De()/2,ke()/2).sub(E(s/2,u/2));h({pos:E(0),width:De(),height:ke(),color:te(0,0,0)}),h({pos:p,width:s,height:u,fill:!1,outline:{width:4}}),h({pos:p,width:s*r,height:u})})}i(Zi,"drawLoadScreen");function Ur(r,s){ut(()=>{let u=E(8);be(),le(r);let p=Tt({text:s,font:Ht,size:16,pos:u,color:te(255,255,255),fixed:!0}),d=p.width+u.x*2,v=p.height+u.x*2;r.x+d>=De()&&le(E(-d,0)),r.y+v>=ke()&&le(E(0,-v)),h({width:d,height:v,color:te(0,0,0),radius:4,opacity:.8,fixed:!0}),St(p),Ae()})}i(Ur,"drawInspectText");function es(){if(ce.inspect){let r=null;for(let s of A.root.get("*",{recursive:!0}))if(s.c("area")&&s.isHovering()){r=s;break}if(A.root.drawInspect(),r){let s=[],u=r.inspect();for(let p in u)u[p]?s.push(`${p}: ${u[p]}`):s.push(`${p}`);Ur(ci(yr()),s.join(`
`))}Ur(E(8),`FPS: ${ce.fps()}`)}ce.paused&&ut(()=>{be(),le(De(),0),le(-8,8);let r=32;h({width:r,height:r,anchor:"topright",color:te(0,0,0),opacity:.8,radius:4,fixed:!0});for(let s=1;s<=2;s++)h({width:4,height:r*.6,anchor:"center",pos:E(-r/3*s,r*.5),color:te(255,255,255),radius:2,fixed:!0});Ae()}),ce.timeScale!==1&&ut(()=>{be(),le(De(),ke()),le(-8,-8);let r=8,s=Tt({text:ce.timeScale.toFixed(1),font:Ht,size:16,color:te(255,255,255),pos:E(-r),anchor:"botright",fixed:!0});h({width:s.width+r*2+r*4,height:s.height+r*2,anchor:"botright",color:te(0,0,0),opacity:.8,radius:4,fixed:!0});for(let u=0;u<2;u++){let p=ce.timeScale<1;re({p1:E(-s.width-r*(p?2:3.5),-r),p2:E(-s.width-r*(p?2:3.5),-r-s.height),p3:E(-s.width-r*(p?3.5:2),-r-s.height/2),pos:E(-u*r*1+(p?-r*.5:0),0),color:te(255,255,255),fixed:!0})}St(s),Ae()}),ce.curRecording&&ut(()=>{be(),le(0,ke()),le(24,-24),Ke({radius:12,color:te(255,0,0),opacity:zn(0,1,m.time()*4),fixed:!0}),Ae()}),ce.showLog&&A.logs.length>0&&ut(()=>{be(),le(0,ke()),le(8,-8);let r=8,s=[];for(let p of A.logs){let d="",v=p.msg instanceof Error?"error":"info";d+=`[time]${p.time.toFixed(2)}[/time]`,d+=" ",d+=`[${v}]${p.msg?.toString?p.msg.toString():p.msg}[/${v}]`,s.push(d)}A.logs=A.logs.filter(p=>m.time()-p.time<(t.logTime||4));let u=Tt({text:s.join(`
`),font:Ht,pos:E(r,-r),anchor:"botleft",size:16,width:De()*.6,lineSpacing:r/2,fixed:!0,styles:{time:{color:te(127,127,127)},info:{color:te(255,255,255)},error:{color:te(255,0,127)}}});h({width:u.width+r*2,height:u.height+r*2,anchor:"botleft",color:te(0,0,0),radius:4,opacity:.8,fixed:!0}),St(u),Ae()})}i(es,"drawDebug");function ts(r){A.events.on("loading",r)}i(ts,"onLoading");function ns(r){m.onResize(r)}i(ns,"onResize");function rs(r){A.events.on("error",r)}i(rs,"onError");function os(r){console.error(r),K.ctx.suspend(),m.run(()=>{Ct(),ut(()=>{let p=De(),d=ke(),v={size:36,width:p-32*2,letterSpacing:4,lineSpacing:4,font:Ht,fixed:!0};h({width:p,height:d,color:te(0,0,255),fixed:!0});let y=Tt({...v,text:"Error",pos:E(32),color:te(255,128,0),fixed:!0});St(y),xr({...v,text:r.message,pos:E(32,32+y.height+16),fixed:!0}),Ae(),A.events.trigger("error",r)}),Mt()})}i(os,"handleErr");function is(r){O.push(r)}i(is,"onCleanup");function ss(){A.events.onOnce("frameEnd",()=>{m.quit(),g.clear(g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT|g.STENCIL_BUFFER_BIT);let r=g.getParameter(g.MAX_TEXTURE_IMAGE_UNITS);for(let s=0;s<r;s++)g.activeTexture(g.TEXTURE0+s),g.bindTexture(g.TEXTURE_2D,null),g.bindTexture(g.TEXTURE_CUBE_MAP,null);g.bindBuffer(g.ARRAY_BUFFER,null),g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,null),g.bindRenderbuffer(g.RENDERBUFFER,null),g.bindFramebuffer(g.FRAMEBUFFER,null),U.destroy(),O.forEach(s=>s())})}i(ss,"quit");let rn=!0;m.run(()=>{try{G.loaded||k()===1&&!rn&&(G.loaded=!0,A.events.trigger("load")),!G.loaded&&t.loadingScreen!==!1||rn?(Ct(),Zi(),Mt()):(ce.paused||Rr(),Qi(),Ct(),Ji(),t.debug!==!1&&es(),Mt()),rn&&(rn=!1),A.events.trigger("frameEnd")}catch(r){os(r)}});function Vr(){let r=c,s=g.drawingBufferWidth/r,u=g.drawingBufferHeight/r;if(t.letterbox){if(!t.width||!t.height)throw new Error("Letterboxing requires width and height defined.");let p=s/u,d=t.width/t.height;if(p>d){let v=u*d,y=(s-v)/2;w.viewport={x:y,y:0,width:v,height:u}}else{let v=s/d,y=(u-v)/2;w.viewport={x:0,y,width:s,height:v}}return}if(t.stretch&&(!t.width||!t.height))throw new Error("Stretching requires width and height defined.");w.viewport={x:0,y:0,width:s,height:u}}i(Vr,"updateViewport");function Pr(){m.onHide(()=>{t.backgroundAudio||K.ctx.suspend()}),m.onShow(()=>{!t.backgroundAudio&&!ce.paused&&K.ctx.resume()}),m.onResize(()=>{if(m.isFullscreen())return;let r=t.width&&t.height;r&&!t.stretch&&!t.letterbox||(n.width=n.offsetWidth*c,n.height=n.offsetHeight*c,Vr(),r||(w.frameBuffer.free(),w.frameBuffer=new yt(U,g.drawingBufferWidth,g.drawingBufferHeight),w.width=g.drawingBufferWidth/c/o,w.height=g.drawingBufferHeight/c/o))}),t.debug!==!1&&(m.onKeyPress(t.debugKey??"f1",()=>ce.inspect=!ce.inspect),m.onKeyPress("f2",()=>ce.clearLog()),m.onKeyPress("f8",()=>ce.paused=!ce.paused),m.onKeyPress("f7",()=>{ce.timeScale=Ln(Qe(ce.timeScale-.2,0,2),1)}),m.onKeyPress("f9",()=>{ce.timeScale=Ln(Qe(ce.timeScale+.2,0,2),1)}),m.onKeyPress("f10",()=>ce.stepFrame())),t.burp&&m.onKeyPress("b",()=>Jt())}if(i(Pr,"initEvents"),Vr(),Pr(),Xe={_k:{kaboomCtx:Xe,app:m,game:A,isFixed:Tr,toFixed:Ln,getViewportScale:ii,getRenderProps:Pi,resolveSprite:$t,drawTexture:Gt,calcTransform:Cr},VERSION:Zs,loadRoot:oe,loadProgress:k,loadSprite:Ee,loadSpriteAtlas:Ie,loadSound:Se,loadMusic:Ve,loadBitmapFont:Ue,loadFont:fe,loadShader:_e,loadShaderURL:ft,loadAseprite:Ne,loadPedit:je,loadBean:ze,loadJSON:J,load:ne,getSprite:rt,getSound:ot,getFont:wt,getBitmapFont:Yt,getShader:Xt,getAsset:Sn,Asset:Re,SpriteData:N,SoundData:z,width:De,height:ke,center:nn,dt:Bn,time:m.time,screenshot:m.screenshot,record:ji,isFocused:Ni,setCursor:m.setCursor,getCursor:m.getCursor,setCursorLocked:m.setCursorLocked,isCursorLocked:m.isCursorLocked,setFullscreen:m.setFullscreen,isFullscreen:m.isFullscreen,isTouchscreen:m.isTouchscreen,onLoad:Di,onLoading:ts,onResize:ns,onGamepadConnect:m.onGamepadConnect,onGamepadDisconnect:m.onGamepadDisconnect,onError:rs,onCleanup:is,camPos:ui,camScale:li,camRot:mi,shake:di,toScreen:hi,toWorld:pi,setGravity:Ti,getGravity:Si,setGravityDirection:Ai,getGravityDirection:Oi,setBackground:Ri,getBackground:Ui,getGamepads:m.getGamepads,add:Bt,make:Fn,destroy:_i,destroyAll:Ki,get:kn,readd:Hi,pos:qt,scale:zt,rotate:zo,color:Vi,opacity:Ao,anchor:Cn,area:Lo,sprite:yn,text:Do,polygon:Ro,rect:Vo,circle:Co,uvquad:Mo,outline:Oo,body:ko,doubleJump:jo,shader:Po,timer:wn,fixed:No,stay:gr,health:Bo,lifespan:Fo,state:Io,z:Yo,move:Ho,offscreen:Ko,follow:_o,fadeIn:To,mask:So,drawon:Eo,raycast:Uo,tile:fr,agent:Go,on:lt,onUpdate:fi,onDraw:gi,onAdd:In,onDestroy:Er,onClick:yi,onCollide:bi,onCollideUpdate:vi,onCollideEnd:xi,onHover:wi,onHoverUpdate:Ci,onHoverEnd:Ei,onKeyDown:m.onKeyDown,onKeyPress:m.onKeyPress,onKeyPressRepeat:m.onKeyPressRepeat,onKeyRelease:m.onKeyRelease,onMouseDown:m.onMouseDown,onMousePress:m.onMousePress,onMouseRelease:m.onMouseRelease,onMouseMove:m.onMouseMove,onCharInput:m.onCharInput,onTouchStart:m.onTouchStart,onTouchMove:m.onTouchMove,onTouchEnd:m.onTouchEnd,onScroll:m.onScroll,onHide:m.onHide,onShow:m.onShow,onGamepadButtonDown:m.onGamepadButtonDown,onGamepadButtonPress:m.onGamepadButtonPress,onGamepadButtonRelease:m.onGamepadButtonRelease,onGamepadStick:m.onGamepadStick,mousePos:yr,mouseDeltaPos:m.mouseDeltaPos,isKeyDown:m.isKeyDown,isKeyPressed:m.isKeyPressed,isKeyPressedRepeat:m.isKeyPressedRepeat,isKeyReleased:m.isKeyReleased,isMouseDown:m.isMouseDown,isMousePressed:m.isMousePressed,isMouseReleased:m.isMouseReleased,isMouseMoved:m.isMouseMoved,isGamepadButtonPressed:m.isGamepadButtonPressed,isGamepadButtonDown:m.isGamepadButtonDown,isGamepadButtonReleased:m.isGamepadButtonReleased,getGamepadStick:m.getGamepadStick,charInputted:m.charInputted,loop:zi,wait:qi,play:Qt,volume:Rn,burp:Jt,audioCtx:K.ctx,Line:Ge,Rect:ae,Circle:Be,Ellipse:Ye,Polygon:Oe,Vec2:C,Color:Z,Mat4:Me,Quad:ue,RNG:It,rand:Lt,randi:Yn,randSeed:Fr,vec2:E,rgb:te,hsl2rgb:Br,quad:he,choose:kr,chooseMultiple:Lr,shuffle:Xn,chance:Ir,lerp:Je,tween:Yi,easings:Vt,map:ht,mapc:Gr,wave:zn,deg2rad:xe,rad2deg:mt,clamp:Qe,evaluateBezier:tr,testLineLine:an,testRectRect:$n,testRectLine:cn,testRectPoint:Wn,testCirclePolygon:kt,testLinePoint:Qn,testLineCircle:Ot,isConvex:rr,triangulate:nr,drawSprite:en,drawText:xr,formatText:Tt,drawRect:h,drawLine:T,drawLines:D,drawTriangle:re,drawCircle:Ke,drawEllipse:at,drawUVQuad:it,drawPolygon:ct,drawCurve:H,drawBezier:ve,drawFormattedText:St,drawMasked:Et,drawSubtracted:br,pushTransform:be,popTransform:Ae,pushTranslate:le,pushScale:de,pushRotate:He,pushMatrix:Mn,usePostEffect:Dn,makeCanvas:Vn,debug:ce,scene:Mi,getSceneName:Fi,go:Gi,onSceneLeave:Bi,addLevel:ki,getData:Ii,setData:Sr,download:mn,downloadJSON:Zr,downloadText:or,downloadBlob:ir,plug:Ar,ASCII_CHARS:hr,canvas:m.canvas,addKaboom:Wi,LEFT:C.LEFT,RIGHT:C.RIGHT,UP:C.UP,DOWN:C.DOWN,RED:Z.RED,GREEN:Z.GREEN,BLUE:Z.BLUE,YELLOW:Z.YELLOW,MAGENTA:Z.MAGENTA,CYAN:Z.CYAN,WHITE:Z.WHITE,BLACK:Z.BLACK,quit:ss,Event:ye,EventHandler:tt,EventController:et},t.plugins&&t.plugins.forEach(Ar),t.global!==!1)for(let r in Xe)window[r]=Xe[r];return t.focus!==!1&&m.canvas.focus(),Xe},"default");return hs(ra);})();
window.kaboom = kaboom.default
//# sourceMappingURL=kaboom.js.map
